(self.webpackChunkgradient_extension_refactor=self.webpackChunkgradient_extension_refactor||[]).push([[973],{5973:()=>{function e(t){var n="function"==typeof Map?new Map:void 0;return e=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return function(e,t,n){if(b())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&w(i,n.prototype),i}(e,arguments,E(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),w(t,e)},e(t)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){return i(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(e,t)||s(e,t)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e){if(Array.isArray(e))return e}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||u(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function u(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(){"use strict";p=function(){return n};var e,n={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new N(r||[]);return a(o,"_invoke",{value:R(e,n,s)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",b={};function g(){}function w(){}function k(){}var S={};l(S,s,(function(){return this}));var E=Object.getPrototypeOf,_=E&&E(E(I([])));_&&_!==r&&i.call(_,s)&&(S=_);var x=k.prototype=g.prototype=Object.create(S);function C(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,n){function r(a,o,s,u){var c=d(e[a],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,i){r(e,t,n,i)}))}return o=o?o.then(i,i):i()}})}function R(t,n,r){var i=h;return function(a,o){if(i===y)throw Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=P(s,r);if(u){if(u===b)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var c=d(t,n,r);if("normal"===c.type){if(i=r.done?m:v,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function P(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var a=d(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,b):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function I(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,o=function t(){for(;++a<n.length;)if(i.call(n,a))return t.value=n[a],t.done=!1,t;return t.value=e,t.done=!0,t};return o.next=o}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=k,a(x,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:w,configurable:!0}),w.displayName=l(k,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},n.awrap=function(e){return{__await:e}},C(T.prototype),l(T.prototype,u,(function(){return this})),n.AsyncIterator=T,n.async=function(e,t,r,i,a){void 0===a&&(a=Promise);var o=new T(f(e,t,r,i),a);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(x),l(x,c,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),b}},n}function h(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){h(a,r,i,o,s,"next",e)}function s(e){h(a,r,i,o,s,"throw",e)}o(void 0)}))}}function y(e,n,r){return n=E(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}(e,b()?Reflect.construct(n,r||[],E(e).constructor):n.apply(e,r))}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function k(e,t,n,r){var i=S(E(1&r?e.prototype:e),t,n);return 2&r?function(e){return i.apply(n,e)}:i}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},S.apply(null,arguments)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function C(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function R(e){return function(){return new P(e.apply(this,arguments))}}function P(e){var t,n;function r(t,n){try{var a=e[t](n),o=a.value,s=o instanceof N;Promise.resolve(s?o.v:o).then((function(n){if(s){var u="return"===t?"return":"next";if(!o.k||n.done)return r(u,n);n=e[u](n).value}i(a.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise((function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function O(e){return new N(e,0)}function A(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise((function(n){n(e[t](r))})),{done:!1,value:new N(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function N(e,t){this.v=e,this.k=t}function I(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new D(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function D(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return D=function(e){this.s=e,this.n=e.next},D.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new D(e)}P.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},P.prototype.next=function(e){return this._invoke("next",e)},P.prototype.throw=function(e){return this._invoke("throw",e)},P.prototype.return=function(e){return this._invoke("return",e)},function(){var c={39:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,t.createLogger=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEBUG;return new r(e)},function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(n||(t.LogLevel=n={}));var r=function(){return C((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.INFO;_(this,e),this.level=n.INFO,this.level=t}),[{key:"formatMessage",value:function(e,t,n){return"[".concat((new Date).toISOString(),"] [").concat(e,"] ").concat(t," ").concat(n.length?JSON.stringify(n):"")}},{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}},{key:"info",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}},{key:"warn",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}},{key:"setLevel",value:function(e){this.level=e}}])}(),i=new r;t.default=i},61:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(609)),a=r(n(483)),o=r(n(39)),s=n(686),u=n(594),c=function(e){function t(e,n){var r;return _(this,t),(r=y(this,t)).ICE_CONFIG={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun.gradient.network:3478"}]},r.heartbeatTime=0,r.pendingCandidates=[],r.peerId=n,r.peerConnection=new RTCPeerConnection(r.ICE_CONFIG),e?r.peerConnection.ondatachannel=function(e){r.dataChannel=e.channel,r.initDataChannel()}:(r.dataChannel=r.peerConnection.createDataChannel("dc-".concat(Date.now())),r.initDataChannel(),r.peerConnection.createOffer().then((function(e){r.peerConnection.setLocalDescription(e),k((m(r),t),"emit",r,3)(["offer",e])}))),r.peerConnection.onicecandidate=function(e){var n=e.candidate;n?(o.default.debug("[P2PClient] gather candidate",n.address,n.port),k((m(r),t),"emit",r,3)(["icecandidate",n])):o.default.debug("[P2PClient] gather candidate done")},r.peerConnection.oniceconnectionstatechange=function(){var e=r.peerConnection.iceConnectionState;o.default.debug("[P2PClient] ice connection state changed",e)},r.peerConnection.onconnectionstatechange=function(){var e=r.peerConnection.connectionState;o.default.debug("[P2PClient] connection state changed",e),r.badState()&&r.close()},r}return g(t,e),C(t,[{key:"badState",value:function(){return!this.peerConnection||["closed","failed","disconnected"].includes(this.peerConnection.connectionState)}},{key:"initDataChannel",value:function(){var e=this;this.dataChannel?(this.dataChannel.onopen=function(n){o.default.debug("[P2PClient] data channel opened",n),e.heartbeatTime=Date.now(),e.checkAlive(),k(t,"emit",e,3)(["connect",{}])},this.dataChannel.onmessage=function(n){e.heartbeatTime=Date.now(),k(t,"emit",e,3)(["data",n.data])},this.dataChannel.onclose=function(t){o.default.debug("[P2PClient] data channel closed",t),e.close()},this.dataChannel.onerror=function(){e.close()}):o.default.error("[P2PClient] data channel is not initialized")}},{key:"checkAlive",value:function(){var e=this;this.checkAliveInterval=setInterval((function(){(e.dataChannel&&"open"!==e.dataChannel.readyState||e.peerConnection&&e.badState()||Date.now()-e.heartbeatTime>i.default.getConnectionIdleTimeout())&&e.close()}),i.default.getCheckAliveInterval())}},{key:"signal",value:(r=v(p().mark((function e(n,r){var i,a,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.peerConnection){e.next=2;break}return e.abrupt("return",void o.default.error("[P2PClient] peer connection is not initialized"));case 2:i=JSON.parse(r),e.prev=3,e.t0=n,e.next="offer"===e.t0?7:"answer"===e.t0?22:"icecandidate"===e.t0?30:"nat_result"===e.t0?37:39;break;case 7:return e.next=9,this.peerConnection.setRemoteDescription(i);case 9:return e.next=11,this.peerConnection.createAnswer();case 11:return a=e.sent,e.next=14,this.peerConnection.setLocalDescription(a);case 14:if(!(this.pendingCandidates.length>0)){e.next=20;break}return s=this.pendingCandidates.shift(),e.next=18,this.peerConnection.addIceCandidate(s);case 18:e.next=14;break;case 20:return k(t,"emit",this,3)(["answer",a]),e.abrupt("break",40);case 22:this.peerConnection.setRemoteDescription(i);case 23:if(!(this.pendingCandidates.length>0)){e.next=29;break}return c=this.pendingCandidates.shift(),e.next=27,this.peerConnection.addIceCandidate(c);case 27:e.next=23;break;case 29:return e.abrupt("break",40);case 30:if(!this.peerConnection.remoteDescription){e.next=35;break}return e.next=33,this.peerConnection.addIceCandidate(i);case 33:e.next=36;break;case 35:this.pendingCandidates.push(i);case 36:return e.abrupt("break",40);case 37:return 4===i.nat_type?u.natRes.update(i.nat_type,!1):u.natRes.update(i.nat_type,!0),e.abrupt("break",40);case 39:o.default.error("[P2PClient] unknown signal:",n);case 40:e.next=45;break;case 42:e.prev=42,e.t1=e.catch(3),o.default.error("[P2PClient] signal error",e.t1),this.close();case 45:case"end":return e.stop()}}),e,this,[[3,42]])}))),function(e,t){return r.apply(this,arguments)})},{key:"getConnected",value:function(){var e;return"open"===(null===(e=this.dataChannel)||void 0===e?void 0:e.readyState)}},{key:"getReadyState",value:function(){var e;return null===(e=this.dataChannel)||void 0===e?void 0:e.readyState}},{key:"sendAsync",value:(n=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.dataChannel&&"open"===this.dataChannel.readyState){e.next=2;break}return e.abrupt("return",!1);case 2:if(!(this.dataChannel.bufferedAmount>2097152)){e.next=15;break}return n=this.dataChannel,e.prev=5,e.next=8,(0,s.wait4)((function(){return n.bufferedAmount<1048576}),1e4);case 8:if(e.sent){e.next=10;break}return e.abrupt("return",!1);case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",!1);case 15:return e.prev=15,e.abrupt("return",(this.dataChannel.send(t),!0));case 19:return e.prev=19,e.t1=e.catch(15),e.abrupt("return",(this.close(),!1));case 22:case"end":return e.stop()}}),e,this,[[5,12],[15,19]])}))),function(e){return n.apply(this,arguments)})},{key:"maxMessageSize",value:function(){var e,t=16384,n=null===(e=this.peerConnection)||void 0===e||null===(e=e.sctp)||void 0===e?void 0:e.maxMessageSize;return n&&n>0&&(t=n),o.default.debug("[P2PClient] max message size",t),t}},{key:"send",value:function(e){if(this.dataChannel&&"open"===this.dataChannel.readyState){var t=!1;if(this.dataChannel.bufferedAmount>262144&&(o.default.warn("[P2PClient] Buffer full, pausing sending..."),t=!0),this.dataChannel.bufferedAmountLowThreshold=65536,!t)try{this.dataChannel.send(e)}catch(e){this.close()}}else o.default.warn("[P2PClient] Cannot send data, data channel is not open")}},{key:"close",value:function(){if(this.checkAliveInterval&&(clearInterval(this.checkAliveInterval),this.checkAliveInterval=void 0),this.dataChannel){try{this.dataChannel.close()}catch(e){o.default.error("[P2PClient] close data channel error",e)}this.dataChannel=void 0}if(this.peerConnection){try{this.peerConnection.close()}catch(e){o.default.error("[P2PClient] close peer connection error",e)}this.peerConnection=void 0}k(t,"emit",this,3)(["close",{}])}}]);var n,r}(a.default);t.default=c},96:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.message=function(e,t,n){return JSON.stringify({method:e,task_id:t,data:n})},t.chunkMessage=function(e,t,n){var r=(new TextEncoder).encode(e),i=3+r.length+4+n.length,a=new ArrayBuffer(i),o=new DataView(a);o.setUint16(0,1,!0),o.setUint8(2,r.length);var s=new Uint8Array(a);s.set(r,3);var u=3+r.length;return o.setUint32(u,t,!0),s.set(n,u+4),s}},142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(686);t.default=function(){return C((function e(){_(this,e),this.chunkBuffer=new Map,this.chunkBuffer=new Map}),[{key:"getChunkBuffer",value:function(){return this.chunkBuffer}},{key:"updateChunkBuffer",value:function(e,t,n){this.chunkBuffer.set((0,r.metaToString)(e),f(f({},this.chunkBuffer.get((0,r.metaToString)(e))),{},d({},t,n)))}},{key:"getMaxChunkIndexByMeta",value:function(e){var t=this.chunkBuffer.get((0,r.metaToString)(e));return t?Math.max.apply(Math,o(Object.keys(t).map(Number))):-1}},{key:"buildFileFromChunkBuffer",value:function(e){var t=this.chunkBuffer.get((0,r.metaToString)(e));if(this.chunkBuffer.delete((0,r.metaToString)(e)),!t)return null;var n,i=Object.keys(t).map(Number).sort((function(e,t){return e-t})),o=0,s=i.map((function(e){var n=t[e],r=Object.values(n);return o+=r.length,new Uint8Array(r)})),u=new Uint8Array(o),c=0,l=a(s);try{for(l.s();!(n=l.n()).done;){var f=n.value;u.set(f,c),c+=f.length}}catch(e){l.e(e)}finally{l.f()}var d=new Blob([u],{type:"application/octet-stream"});return new File([d],e.file_id,{type:"application/octet-stream"})}}],[{key:"getFileUint8Array",value:(e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.arrayBuffer();case 2:return n=e.sent,e.abrupt("return",new Uint8Array(n));case 4:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}]);var e}()},150:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(841),o=n(645),s=r(n(609)),u=n(498),c=new(function(){return C((function e(){_(this,e),this.reportInterval=s.default.getReportInterval(),this.fetchTaskInterval=s.default.getFetchTaskInterval(),this.isPerformingFetchTask=!1,this.fromCDNOnly=!0}),[{key:"setFromCDNOnly",value:function(e){this.fromCDNOnly=e}},{key:"setPeerId",value:function(e){this.peerId=e}},{key:"bindFileService",value:function(e){this.fileService=e}},{key:"setNatType",value:function(e){this.natType=e}},{key:"checkCompleteness",value:function(){if(void 0===this.fileService)throw new Error("FileService is not bound");if(void 0===this.peerId)throw new Error("PeerId is not set");if(void 0===this.natType)throw new Error("NatType is not set");return!0}},{key:"deploySchedule",value:(n=v(p().mark((function e(){var t=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.default.getClientMode()===u.ClientMode.DCDN&&(this.reportTimer=setInterval(v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.performReport();case 2:case"end":return e.stop()}}),e)}))),this.reportInterval),this.fetchTaskTimer=setInterval(v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.performFetchTask();case 2:case"end":return e.stop()}}),e)}))),this.fetchTaskInterval));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getP2PCount",value:function(){try{this.checkCompleteness()}catch(e){return}return this.fileService.getCurrentLoadCount()}},{key:"performReport",value:(t=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=1,this.checkCompleteness(),e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(1),e.abrupt("return",void 0);case 8:return e.next=10,this.fileService.getFileList();case 10:return t=e.sent,e.next=14,(0,i.reportDeviceInfo)({peer_id:this.peerId,p2p_count:this.getP2PCount()||0,nat_type:this.natType,files:t.map((function(e){return{app_id:e.app_id,fid:e.file_id}})),service_addr:"127.0.0.1:8888"});case 14:e.sent;case 16:case"end":return e.stop()}}),e,this,[[1,5]])}))),function(){return t.apply(this,arguments)})},{key:"performFetchTask",value:(e=v(p().mark((function e(){var t,n,r,s,c,l,f,d,h,v;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPerformingFetchTask){e.next=2;break}return e.abrupt("return",void 0);case 2:e.prev=2,this.isPerformingFetchTask=!0,this.checkCompleteness(),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(2),e.abrupt("return",void(this.isPerformingFetchTask=!1));case 9:return e.next=11,(0,i.getDownloadTask)(this.peerId);case 11:if((t=e.sent)!==o.Status.FAILED){e.next=14;break}return e.abrupt("return",void(this.isPerformingFetchTask=!1));case 14:e.prev=14,n=a(t),e.prev=16,n.s();case 18:if((r=n.n()).done){e.next=36;break}return s=r.value,c={resource:s,retryCount:3,peerMode:u.RequestFilePeerMode.AUTO,timeoutFallback:6e4,natType:this.natType},l={resource:s,retryCount:3,peerMode:u.RequestFilePeerMode.MANUAL,manualPeers:[],timeoutFallback:6e4,natType:this.natType},f=this.fromCDNOnly?l:c,e.next=26,this.fileService.requestFile(f);case 26:if((d=e.sent)!==o.Status.FAILED){e.next=30;break}return e.abrupt("continue",34);case 30:return h=d.file,v=d.from,e.next=33,this.fileService.saveFile({app_id:s.app_id,file_id:s.fid},h,v);case 33:case 34:e.next=18;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(16),n.e(e.t1);case 41:return e.prev=41,n.f(),e.finish(41);case 44:e.next=49;break;case 46:e.prev=46,e.t2=e.catch(14),this.isPerformingFetchTask=!1;case 49:return e.prev=49,this.isPerformingFetchTask=!1,e.finish(49);case 52:case"end":return e.stop()}}),e,this,[[2,6],[14,46,49,52],[16,38,41,44]])}))),function(){return e.apply(this,arguments)})},{key:"kill",value:function(){clearInterval(this.reportTimer),clearInterval(this.fetchTaskTimer)}}]);var e,t,n}());t.default=c},157:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(645),o=r(686),s=i(r(39)),u=r(498),c=i(r(477)),l=i(r(609)),f=r(398),d={rtt:-1,signature:""},h=function(e){function t(e){return _(this,t),y(this,t,[e,d])}return g(t,e),C(t,[{key:"initEvent",value:function(){this.on(u.PingMethod.PING,this.handlePing.bind(this)),this.on(u.PingMethod.PING2,this.handlePing2.bind(this)),this.on(u.PingMethod.PONG2,this.handlePong2.bind(this)),this.on(u.PingMethod.PONG,this.handlePong.bind(this))}},{key:"kill",value:function(){this.off(u.PingMethod.PING),this.off(u.PingMethod.PING2),this.off(u.PingMethod.PONG2),this.off(u.PingMethod.PONG)}},{key:"handlePing",value:function(e,t){var n,r,i;(n=t.data).with_signature?(r={method:u.PingMethod.PING2,data:{task_id:n.task_id,send_time:Date.now()}},e.send(JSON.stringify(r))):(i={method:u.PingMethod.PONG,data:{task_id:n.task_id,send_time:Date.now()}},e.send(JSON.stringify(i)))}},{key:"handlePing2",value:function(e,t){var n,r;n=t.data,r={method:u.PingMethod.PONG2,data:{task_id:n.task_id,send_time:n.send_time}},e.send(JSON.stringify(r))}},{key:"handlePong2",value:(h=v(p().mark((function e(t,n){var r,i,a,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.data,i=(Date.now()-r.send_time)/2,s.default.debug("[PingClient] rtt: ".concat(i,"ms")),e.next=3,(0,o.hmac)(l.default.getSkey(),i);case 3:c=e.sent,s.default.debug("[PingClient] signature: ".concat(c)),a={method:u.PingMethod.PONG,data:{task_id:r.task_id,rtt:i,signature:c}},t.send(JSON.stringify(a));case 5:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"handlePong",value:(c=v(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.data,i=r.rtt,r.send_time&&(i=(Date.now()-r.send_time)/2),this.result.set(r.task_id,{rtt:i,signature:r.signature});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_ping",value:(i=v(p().mark((function e(t){var r,i,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepare(t);case 2:if((r=e.sent)!==a.Status.FAILED){e.next=5;break}return e.abrupt("return",d);case 5:return i=n(r,2),o=i[0],s=i[1],c={method:u.PingMethod.PING,data:{task_id:o,send_time:Date.now(),with_signature:!0}},null!=s&&s.send(JSON.stringify(c)),e.next=9,this.waitForResult(o);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"ping",value:(r=v(p().mark((function e(t){var n,r,i,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.length>1&&void 0!==a[1]?a[1]:3,r=d,i=0;case 3:if(e.t0=i<n,!e.t0){e.next=10;break}return s.default.info("[PingClient] ping ".concat(i+1," times")),e.next=8,this._ping(t);case 8:r=e.sent,e.t0=r===d;case 10:if(!e.t0){e.next=15;break}case 12:i++,e.next=3;break;case 15:return e.abrupt("return",((0,f.emitCounter)("p2p_ping",1,{result_code:r!==d?"true":"false"}),r));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]);var r,i,c,h}(c.default);t.default=h},190:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(841),t),i(n(304),t)},195:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(498),a=r(n(61)),o=n(524),s=n(686),u=r(n(39));t.default=function(){return C((function e(t){var n,r,a=this;_(this,e),this.natDetectInterval=i.NatDetectInterval.DEFAULT,this.natDetectIntervalTimer=null,this.peerID=t,this.p2pClients=new Map,null!==(n=(0,o.getRelayClient)())&&void 0!==n&&n.on("connect",(function(){a.startNatTimer(!0)})),null===(r=(0,o.getRelayClient)())||void 0===r||r.on("data",(function(e){if(e.cmd==i.BizCommand.MAKEHOLE){var t=JSON.parse(e.data),n=t.event_name,r=t.from_peer_id,o=t.data,s=a.connect(r,!0);s&&s.signal(n,o)}}))}),[{key:"getSelfPeerId",value:function(){return this.peerID}},{key:"ready",value:function(){var e;return null===(e=(0,o.getRelayClient)())||void 0===e?void 0:e.getConnected()}},{key:"connect",value:function(e,t){var n,r,s=this,c=function(t,n){var r;null===(r=(0,o.getRelayClient)())||void 0===r||r.send(i.BizCommand.MAKEHOLE,{from_peer_id:s.peerID,to_peer_id:e,event_name:t,data:JSON.stringify(n)})};if(this.ready()){var l=null===(n=this.p2pClients)||void 0===n?void 0:n.get(e);return l||(l=new a.default(t,e),null!==(r=this.p2pClients)&&void 0!==r&&r.set(e,l),l.on("offer",(function(e){c("offer",e)})),l.on("answer",(function(e){c("answer",e)})),l.on("icecandidate",(function(e){c("icecandidate",e)})),l.on("connect",(function(){l?s.onConnect&&s.onConnect(l):u.default.error("[P2PManager] client not found")})),l.on("data",(function(e){l?s.onMessage&&s.onMessage(l,e):u.default.error("[P2PManager] client not found")})),l.on("close",(function(){var t;null===(t=s.p2pClients)||void 0===t||t.delete(e)}))),l}}},{key:"bindNatDetectService",value:function(e){this.natDetectService=e}},{key:"updateNatDetectInterval",value:function(e){this.natDetectInterval=e,this.natDetectIntervalTimer&&(clearInterval(this.natDetectIntervalTimer),this.natDetectIntervalTimer=null,this.startNatTimer(!1))}},{key:"startNatTimer",value:function(e){var t=this;this.natDetectIntervalTimer&&(clearInterval(this.natDetectIntervalTimer),this.natDetectIntervalTimer=null);var n=e?0:(0,s.randomInt)(0,(0,s.minute)(5));setTimeout(v(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t.natDetectService&&e,!n.t0){n.next=4;break}return n.next=4,t.performDetectNat();case 4:t.natDetectIntervalTimer=setInterval(v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.natDetectService,!e.t0){e.next=4;break}return e.next=4,t.performDetectNat();case 4:case"end":return e.stop()}}),e)}))),t.natDetectInterval);case 5:case"end":return n.stop()}}),n)}))),n)}},{key:"performDetectNat",value:(e=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.natDetectService){e.next=5;break}return e.next=3,this.natDetectService.detectNat();case 3:t=e.sent,this.updateNatDetectInterval(t.success?i.NatDetectInterval.DEFAULT:i.NatDetectInterval.QUICK);case 5:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"setMessageHandler",value:function(e){this.onMessage=e}},{key:"setConnectHandler",value:function(e){this.onConnect=e}}]);var e}()},222:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EventType=void 0,t.event=function(e,t){return{type:e,timestamp:Date.now(),memo:t}},function(e){e.FILE_P2P="file_p2p",e.FILE_CDN="file_cdn",e.FILE_FAILED="file_failed"}(n||(t.EventType=n={}));var r=new(function(){return C((function e(){_(this,e),this.events=[]}),[{key:"record",value:function(e){this.events.push(e)}},{key:"getAllEvents",value:function(){return this.events}},{key:"getEventsByType",value:function(e){return this.events.filter((function(t){return t.type===e}))}}])}());t.default=r},304:function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DcdnRequestType=t.MetricType=void 0,function(e){e[e.CDN_REQUEST_STATUS=1]="CDN_REQUEST_STATUS"}(n||(t.MetricType=n={})),function(e){e[e.CDN_REQUEST=1]="CDN_REQUEST",e[e.DCDN_REQUEST=2]="DCDN_REQUEST"}(r||(t.DcdnRequestType=r={}))},326:function(e,t,r){"use strict";var i,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),r=0;r<n.length;r++)"default"!==n[r]&&a(t,e,n[r]);return o(t,e),t}),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=r(645),l=u(r(477)),f=r(498),d=u(r(868)),h=r(96),b=r(686),w=u(r(142)),k=u(r(609)),S=u(r(150)),E=r(841),x=r(652),T=s(r(222)),R=r(398),P={status:"File not transferred"},O=function(e){function t(e){var n;return _(this,t),(n=y(this,t,[e,P])).CHUNK_SIZE=64512,n.taskMetaMap=new Map,n.connectedPeers=new Set,n.statisticsService=null,n.firstChunkTimestampMap=new Map,n.currentLoadCount=0,n.persistence=new d.default,n.chunkBufferHelper=new w.default,S.default.setFromCDNOnly(k.default.getDownloadFromCDNOnly()),S.default.bindFileService(m(n)),S.default.deploySchedule(),n}return g(t,e),C(t,[{key:"getCurrentLoadCount",value:function(){return this.currentLoadCount}},{key:"bindStatisticsService",value:function(e){this.statisticsService=e}},{key:"initEvent",value:function(){this.on(f.FileMethod.REQUEST,this.handleRequest.bind(this)),this.on(f.FileMethod.META,this.handleMeta.bind(this)),this.on(f.FileMethod.ERROR,this.handleError.bind(this)),this.on(f.FileMethod.CHUNK,this.handleChunk.bind(this))}},{key:"kill",value:function(){this.off(f.FileMethod.REQUEST),this.off(f.FileMethod.META),this.off(f.FileMethod.ERROR),this.off(f.FileMethod.CHUNK),S.default.kill()}},{key:"handleRequest",value:(B=v(p().mark((function e(t,n){var r,i,a,o,s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.task_id,i=n.data,!(this.currentLoadCount>=k.default.getMaxServingPeers())){e.next=4;break}return e.abrupt("return",void t.send((0,h.message)(f.FileMethod.ERROR,r,{reason:"Current load count exceeds max serving peers"})));case 4:return this.currentLoadCount++,e.next=7,this.persistence.findFileByMeta(i);case 7:if(a=e.sent){e.next=10;break}return e.abrupt("return",void t.send((0,h.message)(f.FileMethod.ERROR,r,{reason:"File not found"})));case 10:return o=t.maxMessageSize()-1024,e.next=13,(0,b.fileMD5)(a);case 13:return s=e.sent,u=Math.ceil(a.size/o),t.send((0,h.message)(f.FileMethod.META,r,{app_id:i.app_id,file_id:i.file_id,size:a.size,hash:s,chunks:u})),e.next=18,this.emitChunks(t,a,r,o);case 18:this.currentLoadCount--;case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return B.apply(this,arguments)})},{key:"emitChunks",value:(U=v(p().mark((function e(t,n,r,i){var a,o,s,u,c,l,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Math.ceil(n.size/i),o=0;case 3:if(!(o<a)){e.next=19;break}return s=o*i,u=Math.min(s+i,n.size),c=n.slice(s,u),e.next=10,c.arrayBuffer();case 10:return l=e.sent,f=new Uint8Array(l),e.next=14,t.sendAsync((0,h.chunkMessage)(r,o,f));case 14:if(e.sent){e.next=16;break}return e.abrupt("return",void 0);case 16:o++,e.next=3;break;case 19:case 20:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return U.apply(this,arguments)})},{key:"handleMeta",value:(j=v(p().mark((function e(t,n){var r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.task_id,i=n.data,(a=this.taskMetaMap.get(r))&&a.app_id===i.app_id&&a.file_id===i.file_id&&(a=i,this.taskMetaMap.set(r,a),this.result.set(r,{status:"connected"}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"handleChunk",value:(L=v(p().mark((function e(t,n){var r,i,a,o,s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.data,a=n.task_id,o=new DataView(i.buffer,i.byteOffset,i.byteLength).getUint32(0,!0),s=new Uint8Array(i.buffer,i.byteOffset+4),null!==(r=this.statisticsService)&&void 0!==r&&r.flagChunk(),(u=this.taskMetaMap.get(a))&&(this.firstChunkTimestampMap.get((0,b.metaToString)(u))||this.firstChunkTimestampMap.set((0,b.metaToString)(u),Date.now()),o<=this.chunkBufferHelper.getMaxChunkIndexByMeta(u)||(this.chunkBufferHelper.updateChunkBuffer(u,o,s),this.result.set(a,{status:"transferring"}),o+1===u.chunks&&this.handleFinalize(a,u)));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"handleFinalize",value:(M=v(p().mark((function e(t,n){var r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.chunkBufferHelper.buildFileFromChunkBuffer(n)){e.next=4;break}return e.abrupt("return",void this.result.set(t,{status:"error",message:"Failed to build file from chunk buffer"}));case 4:return i=n.hash,e.next=7,(0,b.fileMD5)(r);case 7:a=e.sent,i!==a?this.result.set(t,{status:"error",message:"File MD5 mismatch"}):this.result.set(t,{status:"success",file:r});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"handleError",value:(F=v(p().mark((function e(t,n){var r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.task_id,i=n.data,a=i.reason,this.result.set(r,{status:"error",message:a});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return F.apply(this,arguments)})},{key:"saveFile",value:(D=v(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence.saveFile(t,n,r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return D.apply(this,arguments)})},{key:"deleteFile",value:(I=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence.deleteFile(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"getFileList",value:(N=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence.getStatus();case 2:return e.abrupt("return",e.sent.holds);case 3:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"requestFromPeer",value:(A=v(p().mark((function e(t,r){var i,a,o,s,u=this,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>2&&void 0!==l[2]?l[2]:(0,b.minute)(1),a=l.length>3?l[3]:void 0,t!==k.default.getPeerId()){e.next=4;break}return e.abrupt("return",c.Status.FAILED);case 4:return o=new Promise((function(e,t){setTimeout((function(){t(new Error("[RequestFromPeer] Timeout after ".concat(i,"ms")))}),0===i?(0,b.minute)(1):i)})),s=v(p().mark((function e(){var i,o,s,l,d,v,y,m,g;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u.connectedPeers.has(t)||u.connectedPeers.add(t),e.next=4,u.prepare(t);case 4:if((i=e.sent)!==c.Status.FAILED){e.next=7;break}throw new Error("[RequestFromPeer] Failed to prepare");case 7:return o=Date.now(),s=n(i,2),l=s[0],d=s[1],u.taskMetaMap.set(l,{app_id:r.app_id,file_id:r.file_id}),v=(0,h.message)(f.FileMethod.REQUEST,l,r),null!=d&&d.send(v),y=["connected","success","transferring"],e.next=14,(0,b.wait4)((function(){var e;return y.includes((null===(e=u.result.get(l))||void 0===e?void 0:e.status)||"")}),(0,b.second)(1));case 14:if(e.sent){e.next=16;break}throw new Error("[RequestFromPeer] Handshake failed");case 16:return m=Date.now()-o,a(t),e.next=22,(0,b.wait4)((function(){var e;return"success"===(null===(e=u.result.get(l))||void 0===e?void 0:e.status)}),(0,b.minute)(10));case 22:if(e.sent){e.next=24;break}throw new Error("[RequestFromPeer] File request failed");case 24:if(null!=(g=u.result.get(l))&&g.file){e.next=27;break}throw new Error("[RequestFromPeer] File request failed: file is empty");case 27:return e.abrupt("return",(u.connectedPeers.delete(t),u.taskMetaMap.delete(l),{file:g.file,handshakeLatency:m}));case 30:return e.prev=30,e.t0=e.catch(0),e.abrupt("return",(u.connectedPeers.delete(t),c.Status.FAILED));case 33:case"end":return e.stop()}}),e,null,[[0,30]])})))(),e.prev=5,e.next=8,Promise.race([s,o]);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(5),e.abrupt("return",(this.connectedPeers.has(t)&&this.connectedPeers.delete(t),c.Status.FAILED));case 14:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(e,t){return A.apply(this,arguments)})},{key:"requestFromCDN",value:(O=v(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,x.downloadFileFromCDN)(t,n.file_id);case 3:return e.t0=e.sent,e.next=6,(0,b.measureTTFB)(t);case 6:return e.t1=e.sent,e.t2=performance.getEntriesByName(t)[0].duration,e.abrupt("return",{file:e.t0,latency:e.t1,time:e.t2});case 11:return e.prev=11,e.t3=e.catch(0),e.abrupt("return",{file:null,latency:0,time:0});case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),function(e,t){return O.apply(this,arguments)})},{key:"requestHolders",value:(l=v(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.getResourceHolders)(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"requestFile",value:(u=v(p().mark((function e(t){var n,r,i,a,o,s,u,l,d,h,v,y,m,b,g,w,k,S,_=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new Set,u={speed:0,latency:0},l=Date.now(),this.statisticsService,null===(n=this.statisticsService)||void 0===n||n.flagFileStart(),d=[],t.peerMode!==f.RequestFilePeerMode.AUTO){e.next=12;break}return e.next=8,(0,E.getResourceHolders)(t.resource,t.natType);case 8:if((h=e.sent)!==c.Status.FAILED){e.next=11;break}return e.abrupt("return",c.Status.FAILED);case 11:d=h.peer_list.map((function(e){return e.peer_id}));case 12:t.peerMode===f.RequestFilePeerMode.MANUAL&&(d=t.manualPeers),v=t.retryCount,y=0;case 15:if(!(y<v)){e.next=32;break}if(!(d&&d.length>0)){e.next=29;break}return e.prev=18,m=d.map((function(e){return _.requestFromPeer(e,{app_id:t.resource.app_id,file_id:t.resource.fid},t.timeoutFallback,(function(){s.add(e)})).then((function(t){return t===c.Status.FAILED?Promise.reject("[RequestFile] Failed to request from peer: "+e):(u={speed:t.file.size/(Date.now()-l),latency:t.handshakeLatency},{file:t.file,from:e,connectSuccessPeers:s,perf:u})}))})),e.next=22,Promise.any(m);case 22:return b=e.sent,e.abrupt("return",((0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"1",from:"peer",app_id:t.resource.app_id,fid:t.resource.fid}),b));case 26:e.prev=26,e.t0=e.catch(18);case 29:y++,e.next=15;break;case 32:if(0!==t.timeoutFallback){e.next=34;break}return e.abrupt("return",(null!==(r=this.statisticsService)&&void 0!==r&&r.flagFileEnd(0),(0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"0",from:"",app_id:t.resource.app_id,fid:t.resource.fid}),c.Status.FAILED));case 34:return e.next=37,this.requestFromCDN(t.resource.url,{app_id:t.resource.app_id,file_id:t.resource.fid});case 37:return g=e.sent,w=g.file,k=g.latency,S=g.time,e.abrupt("return",(null!==(i=this.statisticsService)&&void 0!==i&&i.flagCdnStatis(k,S,(null==w?void 0:w.size)||0),u={speed:((null==w?void 0:w.size)||0)/S,latency:k},w?(T.default.record((0,T.event)(T.EventType.FILE_CDN,"Fetch from CDN success. Resource: ".concat(t.resource.fid))),(0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"1",from:"cdn",app_id:t.resource.app_id,fid:t.resource.fid}),{file:w,from:"cdn",connectSuccessPeers:s,perf:u}):(T.default.record((0,T.event)(T.EventType.FILE_FAILED,"Failed to fetch from CDN. Resource: ".concat(t.resource.fid))),null!==(a=this.statisticsService)&&void 0!==a&&a.flagFileEnd(0),(0,R.emitCounter)(R.MetricNames.ERROR,1,{name:R.ErrorNames.FILE_CDN_ERROR}),(0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"0",from:"",app_id:t.resource.app_id,fid:t.resource.fid}),null!==(o=t.onFailed)&&void 0!==o&&o.call(t,t.resource.url),c.Status.FAILED)));case 42:case"end":return e.stop()}}),e,this,[[18,26]])}))),function(e){return u.apply(this,arguments)})},{key:"requestFileByP2P",value:(s=v(p().mark((function e(t){var n,r,i,a,o,s,u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Set,i={speed:0,latency:0},a=Date.now(),null!==(n=this.statisticsService)&&void 0!==n&&n.flagFileStart(),t.peers&&0!==t.peers.length){e.next=5;break}return e.abrupt("return",c.Status.FAILED);case 5:return o=t.peers.map((function(e){return u.requestFromPeer(e,{app_id:t.resource.app_id,file_id:t.resource.fid},t.timeoutFallback,(function(){r.add(e)})).then((function(t){return t===c.Status.FAILED?Promise.reject("[RequestFileByP2P] Failed to request from peer: "+e):(i={speed:t.file.size/(Date.now()-a),latency:t.handshakeLatency},{file:t.file,from:e,connectSuccessPeers:r,perf:i})}))})),e.prev=6,e.next=9,Promise.any(o);case 9:return s=e.sent,e.abrupt("return",((0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"1",from:"peer",app_id:t.resource.app_id,fid:t.resource.fid}),s));case 13:return e.prev=13,e.t0=e.catch(6),e.abrupt("return",((0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"0",from:"peer",app_id:t.resource.app_id,fid:t.resource.fid}),c.Status.FAILED));case 16:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e){return s.apply(this,arguments)})},{key:"requestFileByCDN",value:(o=v(p().mark((function e(t){var n,r,i,a,o,s,u,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.requestFromCDN(t.resource.url,{app_id:t.resource.app_id,file_id:t.resource.fid});case 3:return a=e.sent,o=a.file,s=a.latency,u=a.time,null===(n=this.statisticsService)||void 0===n||n.flagCdnStatis(s,u,(null==o?void 0:o.size)||0),l={speed:((null==o?void 0:o.size)||0)/u,latency:s},e.abrupt("return",o?(T.default.record((0,T.event)(T.EventType.FILE_CDN,"Fetch from CDN success. Resource: ".concat(t.resource.fid))),(0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"1",from:"cdn",app_id:t.resource.app_id,fid:t.resource.fid}),{file:o,from:"cdn",connectSuccessPeers:new Set,perf:l}):(T.default.record((0,T.event)(T.EventType.FILE_FAILED,"Failed to fetch from CDN. Resource: ".concat(t.resource.fid))),null!==(r=this.statisticsService)&&void 0!==r&&r.flagFileEnd(0),(0,R.emitCounter)(R.MetricNames.FILE_REQUEST,1,{success:"0",from:"cdn",app_id:t.resource.app_id,fid:t.resource.fid}),null!==(i=t.onFailed)&&void 0!==i&&i.call(t,t.resource.url),c.Status.FAILED));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getConnectedPeers",value:function(){return this.connectedPeers}},{key:"getFileByMeta",value:(a=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence.findFileByMeta(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"requestFileTestV2",value:(i=v(p().mark((function e(t,n){var r,i,a,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.length>2&&void 0!==s[2]?s[2]:6e4,i=null,a=0;case 3:if(!(a<100)){e.next=16;break}return Date.now(),o={resource:n,retryCount:1,peerMode:f.RequestFilePeerMode.MANUAL,manualPeers:[t],timeoutFallback:r,natType:1},e.next=7,this.requestFile(o);case 7:if(i=e.sent,Date.now(),i!==c.Status.FAILED){e.next=11;break}return e.abrupt("return",c.Status.FAILED);case 11:return e.next=13,new Promise((function(e){return setTimeout(e,500)}));case 13:a++,e.next=3;break;case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"requestFileTestAuto",value:(r=v(p().mark((function e(t){var n,r,i,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:6e4,r={resource:t,retryCount:1,peerMode:f.RequestFilePeerMode.AUTO,timeoutFallback:n,natType:1},e.next=4,this.requestFile(r);case 4:return i=e.sent,e.abrupt("return",i===c.Status.FAILED?c.Status.FAILED:i);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]);var r,i,a,o,s,u,l,O,A,N,I,D,F,M,L,j,U,B}(l.default);t.default=O},398:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorNames=t.MetricNames=void 0,t.emitCounter=function(e,t,r){var i;if(u.default.getEnableEmitCounter()){var a={name:e,num:t,tags:f({sdk_version:u.default.getSdkVersion(),biz_version:u.default.getBizVersion()},Object.entries(r).reduce((function(e,t){var r=n(t,2),i=r[0],a=r[1];return e[i]=a,e}),{}))};null===(i=(0,s.getRelayClient)())||void 0===i||i.send(c.BizCommand.METRICS,a)}};var a,o,s=r(524),u=i(r(609)),c=r(498);!function(e){e.SDK_COMPONENTS="sdk_components",e.FILE_REQUEST="file_requests",e.ERROR="error"}(a||(t.MetricNames=a={})),function(e){e.PEER_CONNECTION_ERROR="peer_connection_error",e.FILE_CDN_ERROR="file_cdn_error",e.SEED_ERROR="seed_error",e.MD5_MISMATCH="md5_mismatch"}(o||(t.ErrorNames=o={}))},425:function(e,c,l){"use strict";function h(e,t){return function(){return e.apply(t,arguments)}}var y,m=Object.prototype.toString,b=Object.getPrototypeOf,g=Symbol.iterator,w=Symbol.toStringTag,k=(y=Object.create(null),function(e){var t=m.call(e);return y[t]||(y[t]=t.slice(8,-1).toLowerCase())}),S=function(e){return e=e.toLowerCase(),function(t){return k(t)===e}},E=function(e){return function(n){return t(n)===e}},x=Array.isArray,T=E("undefined"),P=S("ArrayBuffer"),N=E("string"),D=E("function"),F=E("number"),M=function(e){return null!==e&&"object"==t(e)},L=function(e){if("object"!==k(e))return!1;var t=b(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||w in e||g in e)},j=S("Date"),U=S("File"),B=S("Blob"),V=S("FileList"),q=S("URLSearchParams"),z=n(["ReadableStream","Request","Response","Headers"].map(S),4),H=z[0],G=z[1],W=z[2],K=z[3];function J(e,n){var r,i,a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allOwnKeys,o=void 0!==a&&a;if(null!=e)if("object"!=t(e)&&(e=[e]),x(e))for(r=0,i=e.length;r<i;r++)n.call(null,e[r],r,e);else{var s,u=o?Object.getOwnPropertyNames(e):Object.keys(e),c=u.length;for(r=0;r<c;r++)s=u[r],n.call(null,e[s],s,e)}}function Q(e,t){t=t.toLowerCase();for(var n,r=Object.keys(e),i=r.length;i-- >0;)if(t===(n=r[i]).toLowerCase())return n;return null}var X,$,Y,Z,ee,te="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self||"undefined"!=typeof self?self:l.g,ne=function(e){return!T(e)&&e!==te},re=(X="undefined"!=typeof Uint8Array&&b(Uint8Array),function(e){return X&&e instanceof X}),ie=S("HTMLFormElement"),ae=function(){var e=Object.prototype.hasOwnProperty;return function(t,n){return e.call(t,n)}}(),oe=S("RegExp"),se=function(e,t){var n=Object.getOwnPropertyDescriptors(e),r={};J(n,(function(n,i){var a;!1!==(a=t(n,i,e))&&(r[i]=a||n)})),Object.defineProperties(e,r)},ue=S("AsyncFunction"),ce=($="function"==typeof setImmediate,Y=D(te.postMessage),$?setImmediate:Y?(Z="axios@".concat(Math.random()),ee=[],te.addEventListener("message",(function(e){var t=e.source,n=e.data;t===te&&n===Z&&ee.length&&ee.shift()()}),!1),function(e){ee.push(e),te.postMessage(Z,"*")}):function(e){return setTimeout(e)}),le="undefined"!=typeof queueMicrotask?queueMicrotask.bind(te):"undefined"!=typeof process&&process.nextTick||ce,fe={isArray:x,isArrayBuffer:P,isBuffer:function(e){return null!==e&&!T(e)&&null!==e.constructor&&!T(e.constructor)&&D(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:function(e){var t;return e&&("function"==typeof FormData&&e instanceof FormData||D(e.append)&&("formdata"===(t=k(e))||"object"===t&&D(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&P(e.buffer)},isString:N,isNumber:F,isBoolean:function(e){return!0===e||!1===e},isObject:M,isPlainObject:L,isReadableStream:H,isRequest:G,isResponse:W,isHeaders:K,isUndefined:T,isDate:j,isFile:U,isBlob:B,isRegExp:oe,isFunction:D,isStream:function(e){return M(e)&&D(e.pipe)},isURLSearchParams:q,isTypedArray:re,isFileList:V,forEach:J,merge:function e(){for(var t=(ne(this)&&this||{}).caseless,n={},r=function(r,i){var a=t&&Q(n,i)||i;L(n[a])&&L(r)?n[a]=e(n[a],r):L(r)?n[a]=e({},r):x(r)?n[a]=r.slice():n[a]=r},i=0,a=arguments.length;i<a;i++)arguments[i]&&J(arguments[i],r);return n},extend:function(e,t,n){return J(t,(function(t,r){n&&D(t)?e[r]=h(t,n):e[r]=t}),{allOwnKeys:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys}),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n,r){var i,a,o,s={};if(t=t||{},null==e)return t;do{for(a=(i=Object.getOwnPropertyNames(e)).length;a-- >0;)o=i[a],r&&!r(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&b(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:k,kindOfTest:S,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;if(x(e))return e;var t=e.length;if(!F(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},forEachEntry:function(e,t){for(var n,r=(e&&e[g]).call(e);(n=r.next())&&!n.done;){var i=n.value;t.call(e,i[0],i[1])}},matchAll:function(e,t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:ie,hasOwnProperty:ae,hasOwnProp:ae,reduceDescriptors:se,freezeMethods:function(e){se(e,(function(t,n){if(D(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;var r=e[n];D(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=function(){throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:function(e,t){var n={},r=function(e){e.forEach((function(e){n[e]=!0}))};return x(e)?r(e):r(String(e).split(t)),n},toCamelCase:function(e){return e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))},noop:function(){},toFiniteNumber:function(e,t){return null!=e&&Number.isFinite(e=+e)?e:t},findKey:Q,global:te,isContextDefined:ne,isSpecCompliantForm:function(e){return!!(e&&D(e.append)&&"FormData"===e[w]&&e[g])},toJSONObject:function(e){var t=new Array(10),n=function(e,r){if(M(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;var i=x(e)?[]:{};return J(e,(function(e,t){var a=n(e,r+1);!T(a)&&(i[t]=a)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:ue,isThenable:function(e){return e&&(M(e)||D(e))&&D(e.then)&&D(e.catch)},setImmediate:ce,asap:le,isIterable:function(e){return null!=e&&D(e[g])}};function de(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}fe.inherits(de,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.status}}});var pe=de.prototype,he={};function ve(e){return fe.isPlainObject(e)||fe.isArray(e)}function ye(e){return fe.endsWith(e,"[]")?e.slice(0,-2):e}function me(e,t,n){return e?e.concat(t).map((function(e,t){return e=ye(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(e){he[e]={value:e}})),Object.defineProperties(de,he),Object.defineProperty(pe,"isAxiosError",{value:!0}),de.from=function(e,t,n,r,i,a){var o=Object.create(pe);return fe.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(function(e){return"isAxiosError"!==e})),de.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};var be=fe.toFlatObject(fe,{},null,(function(e){return/^is[A-Z]/.test(e)}));function ge(e,n,r){if(!fe.isObject(e))throw new TypeError("target must be an object");n=n||new FormData;var i=(r=fe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!fe.isUndefined(t[e])}))).metaTokens,a=r.visitor||l,o=r.dots,s=r.indexes,u=(r.Blob||"undefined"!=typeof Blob&&Blob)&&fe.isSpecCompliantForm(n);if(!fe.isFunction(a))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(fe.isDate(e))return e.toISOString();if(!u&&fe.isBlob(e))throw new de("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(e)||fe.isTypedArray(e)?u&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,r,a){var u=e;if(e&&!a&&"object"==t(e))if(fe.endsWith(r,"{}"))r=i?r:r.slice(0,-2),e=JSON.stringify(e);else if(fe.isArray(e)&&function(e){return fe.isArray(e)&&!e.some(ve)}(e)||(fe.isFileList(e)||fe.endsWith(r,"[]"))&&(u=fe.toArray(e)))return r=ye(r),u.forEach((function(e,t){!fe.isUndefined(e)&&null!==e&&n.append(!0===s?me([r],t,o):null===s?r:r+"[]",c(e))})),!1;return!!ve(e)||(n.append(me(a,r,o),c(e)),!1)}var f=[],d=Object.assign(be,{defaultVisitor:l,convertValue:c,isVisitable:ve});if(!fe.isObject(e))throw new TypeError("data must be an object");return function e(t,r){if(!fe.isUndefined(t)){if(-1!==f.indexOf(t))throw Error("Circular reference detected in "+r.join("."));f.push(t),fe.forEach(t,(function(t,i){!0===(!(fe.isUndefined(t)||null===t)&&a.call(n,t,fe.isString(i)?i.trim():i,r,d))&&e(t,r?r.concat(i):[i])})),f.pop()}}(e),n}function we(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function ke(e,t){this._pairs=[],e&&ge(e,this,t)}var Se=ke.prototype;function Ee(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _e(e,t,n){if(!t)return e;var r=n&&n.encode||Ee;fe.isFunction(n)&&(n={serialize:n});var i,a=n&&n.serialize;if(i=a?a(t,n):fe.isURLSearchParams(t)?t.toString():new ke(t,n).toString(r)){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}Se.append=function(e,t){this._pairs.push([e,t])},Se.toString=function(e){var t=e?function(t){return e.call(this,t,we)}:we;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var xe=function(){return C((function e(){_(this,e),this.handlers=[]}),[{key:"use",value:function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){fe.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}])}(),Ce={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Te={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ke,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Re="undefined"!=typeof self&&"undefined"!=typeof document,Pe="object"==("undefined"==typeof navigator?"undefined":t(navigator))&&navigator||void 0,Oe=Re&&(!Pe||["ReactNative","NativeScript","NS"].indexOf(Pe.product)<0),Ae="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Ne=Re&&self.location.href||"http://localhost",Ie=f(f({},Object.freeze({__proto__:null,hasBrowserEnv:Re,hasStandardBrowserWebWorkerEnv:Ae,hasStandardBrowserEnv:Oe,navigator:Pe,origin:Ne})),Te);function De(e){function t(e,n,r,i){var a=e[i++];if("__proto__"===a)return!0;var o=Number.isFinite(+a),s=i>=e.length;return a=!a&&fe.isArray(r)?r.length:a,s?(fe.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!o):(r[a]&&fe.isObject(r[a])||(r[a]=[]),t(e,n,r[a],i)&&fe.isArray(r[a])&&(r[a]=function(e){var t,n,r={},i=Object.keys(e),a=i.length;for(t=0;t<a;t++)r[n=i[t]]=e[n];return r}(r[a])),!o)}if(fe.isFormData(e)&&fe.isFunction(e.entries)){var n={};return fe.forEachEntry(e,(function(e,r){t(function(e){return fe.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),r,n,0)})),n}return null}var Fe={transitional:Ce,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){var n,r=t.getContentType()||"",i=r.indexOf("application/json")>-1,a=fe.isObject(e);if(a&&fe.isHTMLForm(e)&&(e=new FormData(e)),fe.isFormData(e))return i?JSON.stringify(De(e)):e;if(fe.isArrayBuffer(e)||fe.isBuffer(e)||fe.isStream(e)||fe.isFile(e)||fe.isBlob(e)||fe.isReadableStream(e))return e;if(fe.isArrayBufferView(e))return e.buffer;if(fe.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ge(e,new Ie.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return Ie.isNode&&fe.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((n=fe.isFileList(e))||r.indexOf("multipart/form-data")>-1){var o=this.env&&this.env.FormData;return ge(n?{"files[]":e}:e,o&&new o,this.formSerializer)}}return a||i?(t.setContentType("application/json",!1),function(e){if(fe.isString(e))try{return(0,JSON.parse)(e),fe.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||Fe.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(fe.isResponse(e)||fe.isReadableStream(e))return e;if(e&&fe.isString(e)&&(n&&!this.responseType||r)){var i=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw de.from(e,de.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ie.classes.FormData,Blob:Ie.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],(function(e){Fe.headers[e]={}}));var Me=Fe,Le=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),je=Symbol("internals");function Ue(e){return e&&String(e).trim().toLowerCase()}function Be(e){return!1===e||null==e?e:fe.isArray(e)?e.map(Be):String(e)}function Ve(e,t,n,r,i){return fe.isFunction(r)?r.call(this,t,n):(i&&(t=n),fe.isString(t)?fe.isString(r)?-1!==t.indexOf(r):fe.isRegExp(r)?r.test(t):void 0:void 0)}var qe=function(){return C((function e(t){_(this,e),t&&this.set(t)}),[{key:"set",value:function(e,t,n){var r=this;function i(e,t,n){var i=Ue(t);if(!i)throw new Error("header name must be a non-empty string");var a=fe.findKey(r,i);(!a||void 0===r[a]||!0===n||void 0===n&&!1!==r[a])&&(r[a||t]=Be(e))}var s=function(e,t){return fe.forEach(e,(function(e,n){return i(e,n,t)}))};if(fe.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(fe.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s(function(e){var t,n,r,i={};return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!t||i[t]&&Le[t]||("set-cookie"===t?i[t]?i[t].push(n):i[t]=[n]:i[t]=i[t]?i[t]+", "+n:n)})),i}(e),t);else if(fe.isObject(e)&&fe.isIterable(e)){var u,c,l,f={},d=a(e);try{for(d.s();!(l=d.n()).done;){var p=l.value;if(!fe.isArray(p))throw TypeError("Object iterator must return a key-value pair");f[c=p[0]]=(u=f[c])?fe.isArray(u)?[].concat(o(u),[p[1]]):[u,p[1]]:p[1]}}catch(e){d.e(e)}finally{d.f()}s(f,t)}else null!=e&&i(t,e,n);return this}},{key:"get",value:function(e,t){if(e=Ue(e)){var n=fe.findKey(this,e);if(n){var r=this[n];if(!t)return r;if(!0===t)return function(e){for(var t,n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;t=r.exec(e);)n[t[1]]=t[2];return n}(r);if(fe.isFunction(t))return t.call(this,r,n);if(fe.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(e,t){if(e=Ue(e)){var n=fe.findKey(this,e);return!(!n||void 0===this[n]||t&&!Ve(0,this[n],n,t))}return!1}},{key:"delete",value:function(e,t){var n=this,r=!1;function i(e){if(e=Ue(e)){var i=fe.findKey(n,e);!i||t&&!Ve(0,n[i],i,t)||(delete n[i],r=!0)}}return fe.isArray(e)?e.forEach(i):i(e),r}},{key:"clear",value:function(e){for(var t=Object.keys(this),n=t.length,r=!1;n--;){var i=t[n];e&&!Ve(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}},{key:"normalize",value:function(e){var t=this,n={};return fe.forEach(this,(function(r,i){var a=fe.findKey(n,i);if(a)return t[a]=Be(r),void delete t[i];var o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))}(i):String(i).trim();o!==i&&delete t[i],t[o]=Be(r),n[o]=!0})),this}},{key:"concat",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.constructor).concat.apply(e,[this].concat(n))}},{key:"toJSON",value:function(e){var t=Object.create(null);return fe.forEach(this,(function(n,r){null!=n&&!1!==n&&(t[r]=e&&fe.isArray(n)?n.join(", "):n)})),t}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(e){var t=n(e,2);return t[0]+": "+t[1]})).join("\n")}},{key:"getSetCookie",value:function(){return this.get("set-cookie")||[]}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(e){return e instanceof this?e:new this(e)}},{key:"concat",value:function(e){for(var t=new this(e),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach((function(e){return t.set(e)})),t}},{key:"accessor",value:function(e){var t=(this[je]=this[je]={accessors:{}}).accessors,n=this.prototype;function r(e){var r=Ue(e);t[r]||(function(e,t){var n=fe.toCamelCase(" "+t);["get","set","has"].forEach((function(r){Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return fe.isArray(e)?e.forEach(r):r(e),this}}])}();qe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),fe.reduceDescriptors(qe.prototype,(function(e,t){var n=e.value,r=t[0].toUpperCase()+t.slice(1);return{get:function(){return n},set:function(e){this[r]=e}}})),fe.freezeMethods(qe);var ze=qe;function He(e,t){var n=this||Me,r=t||n,i=ze.from(r.headers),a=r.data;return fe.forEach(e,(function(e){a=e.call(n,a,i.normalize(),t?t.status:void 0)})),i.normalize(),a}function Ge(e){return!(!e||!e.__CANCEL__)}function We(e,t,n){de.call(this,null==e?"canceled":e,de.ERR_CANCELED,t,n),this.name="CanceledError"}function Ke(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new de("Request failed with status code "+n.status,[de.ERR_BAD_REQUEST,de.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}fe.inherits(We,de,{__CANCEL__:!0});var Je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0,i=function(e,t){e=e||10;var n,r=new Array(e),i=new Array(e),a=0,o=0;return t=void 0!==t?t:1e3,function(s){var u=Date.now(),c=i[o];n||(n=u),r[a]=s,i[a]=u;for(var l=o,f=0;l!==a;)f+=r[l++],l%=e;if((a=(a+1)%e)===o&&(o=(o+1)%e),!(u-n<t)){var d=c&&u-c;return d?Math.round(1e3*f/d):void 0}}}(50,250);return function(e,t){var n,r,i=0,a=1e3/t,o=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();i=a,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){for(var e=Date.now(),t=e-i,s=arguments.length,u=new Array(s),c=0;c<s;c++)u[c]=arguments[c];t>=a?o(u,e):(n=u,r||(r=setTimeout((function(){r=null,o(n)}),a-t)))},function(){return n&&o(n)}]}((function(n){var a=n.loaded,o=n.lengthComputable?n.total:void 0,s=a-r,u=i(s);r=a,e(d({loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:u||void 0,estimated:u&&o&&a<=o?(o-a)/u:void 0,event:n,lengthComputable:null!=o},t?"download":"upload",!0))}),n)},Qe=function(e,t){var n=null!=e;return[function(r){return t[0]({lengthComputable:n,total:e,loaded:r})},t[1]]},Xe=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return fe.asap((function(){return e.apply(void 0,n)}))}},$e=Ie.hasStandardBrowserEnv?function(e,t){return function(n){return n=new URL(n,Ie.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)}}(new URL(Ie.origin),Ie.navigator&&/(msie|trident)/i.test(Ie.navigator.userAgent)):function(){return!0},Ye=Ie.hasStandardBrowserEnv?{write:function(e,t,n,r,i,a){var o=[e+"="+encodeURIComponent(t)];fe.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),fe.isString(r)&&o.push("path="+r),fe.isString(i)&&o.push("domain="+i),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Ze(e,t,n){var r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var et=function(e){return e instanceof ze?f({},e):e};function tt(e,t){t=t||{};var n={};function r(e,t,n,r){return fe.isPlainObject(e)&&fe.isPlainObject(t)?fe.merge.call({caseless:r},e,t):fe.isPlainObject(t)?fe.merge({},t):fe.isArray(t)?t.slice():t}function i(e,t,n,i){return fe.isUndefined(t)?fe.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function a(e,t){if(!fe.isUndefined(t))return r(void 0,t)}function o(e,t){return fe.isUndefined(t)?fe.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,a){return a in t?r(n,i):a in e?r(void 0,n):void 0}var u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:function(e,t){return i(et(e),et(t),0,!0)}};return fe.forEach(Object.keys(Object.assign({},e,t)),(function(r){var a=u[r]||i,o=a(e[r],t[r],r);fe.isUndefined(o)&&a!==s||(n[r]=o)})),n}var nt,rt,it=function(e){var t,n=tt({},e),a=n.data,c=n.withXSRFToken,l=n.xsrfHeaderName,f=n.xsrfCookieName,d=n.headers,p=n.auth;if(n.headers=d=ze.from(d),n.url=_e(Ze(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),p&&d.set("Authorization","Basic "+btoa((p.username||"")+":"+(p.password?unescape(encodeURIComponent(p.password)):""))),fe.isFormData(a))if(Ie.hasStandardBrowserEnv||Ie.hasStandardBrowserWebWorkerEnv)d.setContentType(void 0);else if(!1!==(t=d.getContentType())){var h=t?t.split(";").map((function(e){return e.trim()})).filter(Boolean):[],v=function(e){return i(e)||u(e)||s(e)||r()}(h),y=v[0],m=v.slice(1);d.setContentType([y||"multipart/form-data"].concat(o(m)).join("; "))}if(Ie.hasStandardBrowserEnv&&(c&&fe.isFunction(c)&&(c=c(n)),c||!1!==c&&$e(n.url))){var b=l&&f&&Ye.read(f);b&&d.set(l,b)}return n},at="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,r){var i,a,o,s,u,c,l,f=it(e),d=f.data,p=ze.from(f.headers).normalize(),h=f.responseType,v=f.onUploadProgress,y=f.onDownloadProgress;function m(){c&&c(),l&&l(),f.cancelToken&&f.cancelToken.unsubscribe(o),f.signal&&f.signal.removeEventListener("abort",o)}var b=new XMLHttpRequest;function g(){if(b){var n=ze.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders());Ke((function(e){t(e),m()}),(function(e){r(e),m()}),{data:h&&"text"!==h&&"json"!==h?b.response:b.responseText,status:b.status,statusText:b.statusText,headers:n,config:e,request:b}),b=null}}b.open(f.method.toUpperCase(),f.url,!0),b.timeout=f.timeout,"onloadend"in b?b.onloadend=g:b.onreadystatechange=function(){b&&4===b.readyState&&(0!==b.status||b.responseURL&&0===b.responseURL.indexOf("file:"))&&setTimeout(g)},b.onabort=function(){b&&(r(new de("Request aborted",de.ECONNABORTED,e,b)),b=null)},b.onerror=function(){r(new de("Network Error",de.ERR_NETWORK,e,b)),b=null},b.ontimeout=function(){var t=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded",n=f.transitional||Ce;f.timeoutErrorMessage&&(t=f.timeoutErrorMessage),r(new de(t,n.clarifyTimeoutError?de.ETIMEDOUT:de.ECONNABORTED,e,b)),b=null},void 0===d&&p.setContentType(null),"setRequestHeader"in b&&fe.forEach(p.toJSON(),(function(e,t){b.setRequestHeader(t,e)})),fe.isUndefined(f.withCredentials)||(b.withCredentials=!!f.withCredentials),h&&"json"!==h&&(b.responseType=f.responseType),y&&(u=(i=n(Je(y,!0),2))[0],l=i[1],b.addEventListener("progress",u)),v&&b.upload&&(s=(a=n(Je(v),2))[0],c=a[1],b.upload.addEventListener("progress",s),b.upload.addEventListener("loadend",c)),(f.cancelToken||f.signal)&&(o=function(t){b&&(r(!t||t.type?new We(null,e,b):t),b.abort(),b=null)},f.cancelToken&&f.cancelToken.subscribe(o),f.signal&&(f.signal.aborted?o():f.signal.addEventListener("abort",o)));var w=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(f.url);w&&-1===Ie.protocols.indexOf(w)?r(new de("Unsupported protocol "+w+":",de.ERR_BAD_REQUEST,e)):b.send(d||null)}))},ot=function(e,t){var n=(e=e?e.filter(Boolean):[]).length;if(t||n){var r,i=new AbortController,a=function(e){if(!r){r=!0,s();var t=e instanceof Error?e:this.reason;i.abort(t instanceof de?t:new We(t instanceof Error?t.message:t))}},o=t&&setTimeout((function(){o=null,a(new de("timeout ".concat(t," of ms exceeded"),de.ETIMEDOUT))}),t),s=function(){e&&(o&&clearTimeout(o),o=null,e.forEach((function(e){e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((function(e){return e.addEventListener("abort",a)}));var u=i.signal;return u.unsubscribe=function(){return fe.asap(s)},u}},st=p().mark((function e(t,n){var r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.byteLength,n&&!(r<n)){e.next=5;break}return e.next=4,t;case 4:return e.abrupt("return",void e.sent);case 5:a=0;case 6:if(!(a<r)){e.next=13;break}return i=a+n,e.next=10,t.slice(a,i);case 10:a=i;case 11:e.next=6;break;case 13:case"end":return e.stop()}}),e)})),ut=function(e,t,n,r){var i,a,o=(i=R(p().mark((function e(t,n){var r,i,a,o,s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,i=!1,e.prev=2,o=I(function(){var e=R(p().mark((function e(t){var n,r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t[Symbol.asyncIterator]){e.next=3;break}return e.delegateYield(A(I(t)),"t0",2);case 2:return e.abrupt("return",void e.t0);case 3:n=t.getReader(),e.prev=4;case 5:return e.next=7,O(n.read());case 7:if(r=e.sent,i=r.done,a=r.value,!i){e.next=12;break}return e.abrupt("break",16);case 12:return e.next=14,a;case 14:e.next=5;break;case 16:return e.prev=16,e.next=19,O(n.cancel());case 19:return e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[4,,16,20]])})));return function(t){return e.apply(this,arguments)}}()(t));case 4:return e.next=6,O(o.next());case 6:if(!(r=!(s=e.sent).done)){e.next=12;break}return u=s.value,e.delegateYield(A(I(st(u,n))),"t0",9);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),i=!0,a=e.t1;case 18:if(e.prev=18,e.prev=19,!r||null==o.return){e.next=23;break}return e.next=23,O(o.return());case 23:if(e.prev=23,!i){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])}))),function(e,t){return i.apply(this,arguments)})(e,t),s=0,u=function(e){a||(a=!0,r&&r(e))};return new ReadableStream({pull:function(e){return v(p().mark((function t(){var r,i,a,c,l;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.next();case 3:if(r=t.sent,i=r.done,a=r.value,!i){t.next=8;break}return t.abrupt("return",(u(),void e.close()));case 8:c=a.byteLength,n&&(l=s+=c,n(l)),e.enqueue(new Uint8Array(a)),t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(0),u(t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},cancel:function(e){return u(e),o.return()}},{highWaterMark:2})},ct="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,lt=ct&&"function"==typeof ReadableStream,ft=ct&&("function"==typeof TextEncoder?(nt=new TextEncoder,function(e){return nt.encode(e)}):function(){var e=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uint8Array,e.next=3,new Response(t).arrayBuffer();case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),dt=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e.apply(void 0,n)}catch(e){return!1}},pt=lt&&dt((function(){var e=!1,t=new Request(Ie.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),ht=lt&&dt((function(){return fe.isReadableStream(new Response("").body)})),vt={stream:ht&&function(e){return e.body}};ct&&(rt=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((function(e){!vt[e]&&(vt[e]=fe.isFunction(rt[e])?function(t){return t[e]()}:function(t,n){throw new de("Response type '".concat(e,"' is not supported"),de.ERR_NOT_SUPPORT,n)})})));var yt={http:null,xhr:at,fetch:ct&&function(){var e=v(p().mark((function e(t){var r,i,a,o,s,u,c,l,d,h,y,m,b,g,w,k,S,E,_,x,C,T,R,P,O,A,N,I,D,F,M,L,j,U;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=it(t),i=r.url,a=r.method,o=r.data,s=r.signal,u=r.cancelToken,c=r.timeout,l=r.onDownloadProgress,d=r.onUploadProgress,h=r.responseType,y=r.headers,m=r.withCredentials,b=void 0===m?"same-origin":m,g=r.fetchOptions,h=h?(h+"").toLowerCase():"text",k=ot([s,u&&u.toAbortSignal()],c),S=k&&k.unsubscribe&&function(){k.unsubscribe()},e.prev=4,e.t0=d&&pt&&"get"!==a&&"head"!==a,!e.t0){e.next=11;break}return e.next=9,function(){var e=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=fe.toFiniteNumber(t.getContentLength()),e.abrupt("return",null==r?function(){var e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return",0);case 2:if(!fe.isBlob(t)){e.next=4;break}return e.abrupt("return",t.size);case 4:if(!fe.isSpecCompliantForm(t)){e.next=9;break}return n=new Request(Ie.origin,{method:"POST",body:t}),e.next=8,n.arrayBuffer();case 8:return e.abrupt("return",e.sent.byteLength);case 9:if(!fe.isArrayBufferView(t)&&!fe.isArrayBuffer(t)){e.next=13;break}e.t0=t.byteLength,e.next=22;break;case 13:if(fe.isURLSearchParams(t)&&(t+=""),!fe.isString(t)){e.next=20;break}return e.next=17,ft(t);case 17:e.t1=e.sent.byteLength,e.next=21;break;case 20:e.t1=void 0;case 21:e.t0=e.t1;case 22:return e.abrupt("return",e.t0);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(n):r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(y,o);case 9:e.t1=E=e.sent,e.t0=0!==e.t1;case 11:if(!e.t0){e.next=14;break}x=new Request(i,{method:"POST",body:o,duplex:"half"}),fe.isFormData(o)&&(_=x.headers.get("content-type"))&&y.setContentType(_),x.body&&(C=Qe(E,Je(Xe(d))),T=n(C,2),R=T[0],P=T[1],o=ut(x.body,65536,R,P));case 14:return fe.isString(b)||(b=b?"include":"omit"),O="credentials"in Request.prototype,w=new Request(i,f(f({},g),{},{signal:k,method:a.toUpperCase(),headers:y.normalize().toJSON(),body:o,duplex:"half",credentials:O?b:void 0})),e.next=19,fetch(w);case 19:return A=e.sent,N=ht&&("stream"===h||"response"===h),ht&&(l||N&&S)&&(I={},["status","statusText","headers"].forEach((function(e){I[e]=A[e]})),D=fe.toFiniteNumber(A.headers.get("content-length")),F=l&&Qe(D,Je(Xe(l),!0))||[],M=n(F,2),L=M[0],j=M[1],A=new Response(ut(A.body,65536,L,(function(){j&&j(),S&&S()})),I)),h=h||"text",e.next=25,vt[fe.findKey(vt,h)||"text"](A,t);case 25:return U=e.sent,!N&&S&&S(),e.next=29,new Promise((function(e,n){Ke(e,n,{data:U,headers:ze.from(A.headers),status:A.status,statusText:A.statusText,config:t,request:w})}));case 29:return e.abrupt("return",e.sent);case 32:if(e.prev=32,e.t2=e.catch(4),S&&S(),!e.t2||"TypeError"!==e.t2.name||!/Load failed|fetch/i.test(e.t2.message)){e.next=36;break}throw Object.assign(new de("Network Error",de.ERR_NETWORK,t,w),{cause:e.t2.cause||e.t2});case 36:throw de.from(e.t2,e.t2&&e.t2.code,t,w);case 37:case"end":return e.stop()}}),e,null,[[4,32]])})));return function(t){return e.apply(this,arguments)}}()};fe.forEach(yt,(function(e,t){if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));var mt=function(e){return"- ".concat(e)},bt=function(e){return fe.isFunction(e)||null===e||!1===e},gt=function(e){for(var t,r,i=(e=fe.isArray(e)?e:[e]).length,a={},o=0;o<i;o++){var s=void 0;if(r=t=e[o],!bt(t)&&void 0===(r=yt[(s=String(t)).toLowerCase()]))throw new de("Unknown adapter '".concat(s,"'"));if(r)break;a[s||"#"+o]=r}if(!r){var u=Object.entries(a).map((function(e){var t=n(e,2),r=t[0],i=t[1];return"adapter ".concat(r," ")+(!1===i?"is not supported by the environment":"is not available in the build")}));throw new de("There is no suitable adapter to dispatch the request "+(i?u.length>1?"since :\n"+u.map(mt).join("\n"):" "+mt(u[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r};function wt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new We(null,e)}function kt(e){return wt(e),e.headers=ze.from(e.headers),e.data=He.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gt(e.adapter||Me.adapter)(e).then((function(t){return wt(e),t.data=He.call(e,e.transformResponse,t),t.headers=ze.from(t.headers),t}),(function(t){return Ge(t)||(wt(e),t&&t.response&&(t.response.data=He.call(e,e.transformResponse,t.response),t.response.headers=ze.from(t.response.headers))),Promise.reject(t)}))}var St={};["object","boolean","number","function","string","symbol"].forEach((function(e,n){St[e]=function(r){return t(r)===e||"a"+(n<1?"n ":" ")+e}}));var Et={};St.transitional=function(e,t,n){function r(e,t){return"[Axios v1.9.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,a){if(!1===e)throw new de(r(i," has been removed"+(t?" in "+t:"")),de.ERR_DEPRECATED);return t&&!Et[i]&&(Et[i]=!0),!e||e(n,i,a)}},St.spelling=function(){return function(){return!0}};var _t={assertOptions:function(e,n,r){if("object"!=t(e))throw new de("options must be an object",de.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(e),a=i.length;a-- >0;){var o=i[a],s=n[o];if(s){var u=e[o],c=void 0===u||s(u,o,e);if(!0!==c)throw new de("option "+o+" must be "+c,de.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new de("Unknown option "+o,de.ERR_BAD_OPTION)}},validators:St},xt=_t.validators,Ct=function(){return C((function e(t){_(this,e),this.defaults=t||{},this.interceptors={request:new xe,response:new xe}}),[{key:"request",value:(e=v(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._request(t,n);case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),e.t0 instanceof Error){r={},Error.captureStackTrace?Error.captureStackTrace(r):r=new Error,i=r.stack?r.stack.replace(/^.+\n/,""):"";try{e.t0.stack?i&&!String(e.t0.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(e.t0.stack+="\n"+i):e.t0.stack=i}catch(e){}}throw e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(t,n){return e.apply(this,arguments)})},{key:"_request",value:function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{};var n=t=tt(this.defaults,t),r=n.transitional,i=n.paramsSerializer,a=n.headers;void 0!==r&&_t.assertOptions(r,{silentJSONParsing:xt.transitional(xt.boolean),forcedJSONParsing:xt.transitional(xt.boolean),clarifyTimeoutError:xt.transitional(xt.boolean)},!1),null!=i&&(fe.isFunction(i)?t.paramsSerializer={serialize:i}:_t.assertOptions(i,{encode:xt.function,serialize:xt.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),_t.assertOptions(t,{baseUrl:xt.spelling("baseURL"),withXsrfToken:xt.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();var o=a&&fe.merge(a.common,a[t.method]);a&&fe.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete a[e]})),t.headers=ze.concat(o,a);var s=[],u=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(u=u&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));var c,l=[];this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));var f,d=0;if(!u){var p=[kt.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,l),f=p.length,c=Promise.resolve(t);d<f;)c=c.then(p[d++],p[d++]);return c}f=s.length;var h=t;for(d=0;d<f;){var v=s[d++],y=s[d++];try{h=v(h)}catch(e){y.call(this,e);break}}try{c=kt.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,f=l.length;d<f;)c=c.then(l[d++],l[d++]);return c}},{key:"getUri",value:function(e){return _e(Ze((e=tt(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}]);var e}();fe.forEach(["delete","get","head","options"],(function(e){Ct.prototype[e]=function(t,n){return this.request(tt(n||{},{method:e,url:t,data:(n||{}).data}))}})),fe.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(tt(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Ct.prototype[e]=t(),Ct.prototype[e+"Form"]=t(!0)}));var Tt=Ct,Rt=function(){function e(t){if(_(this,e),"function"!=typeof t)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(e){n=e}));var r=this;this.promise.then((function(e){if(r._listeners){for(var t=r._listeners.length;t-- >0;)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},t((function(e,t,i){r.reason||(r.reason=new We(e,t,i),n(r.reason))}))}return C(e,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}},{key:"unsubscribe",value:function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}}},{key:"toAbortSignal",value:function(){var e=this,t=new AbortController,n=function(e){t.abort(e)};return this.subscribe(n),t.signal.unsubscribe=function(){return e.unsubscribe(n)},t.signal}}],[{key:"source",value:function(){var t;return{token:new e((function(e){t=e})),cancel:t}}}])}(),Pt=Rt,Ot={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ot).forEach((function(e){var t=n(e,2),r=t[0],i=t[1];Ot[i]=r}));var At=Ot,Nt=function e(t){var n=new Tt(t),r=h(Tt.prototype.request,n);return fe.extend(r,Tt.prototype,n,{allOwnKeys:!0}),fe.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(tt(t,n))},r}(Me);Nt.Axios=Tt,Nt.CanceledError=We,Nt.CancelToken=Pt,Nt.isCancel=Ge,Nt.VERSION="1.9.0",Nt.toFormData=ge,Nt.AxiosError=de,Nt.Cancel=Nt.CanceledError,Nt.all=function(e){return Promise.all(e)},Nt.spread=function(e){return function(t){return e.apply(null,t)}},Nt.isAxiosError=function(e){return fe.isObject(e)&&!0===e.isAxiosError},Nt.mergeConfig=tt,Nt.AxiosHeaders=ze,Nt.formToJSON=function(e){return De(fe.isHTMLForm(e)?new FormData(e):e)},Nt.getAdapter=gt,Nt.HttpStatusCode=At,Nt.default=Nt,e.exports=Nt},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(917),i=n(686),a=n(645);t.default=function(){return C((function e(t,n){_(this,e),this.manager=t,this.defaultResult=n,this.initEvent(),this.result=new Map}),[{key:"on",value:function(e,t){(0,r.getEventDispatcher)().on(e,t)}},{key:"off",value:function(e){(0,r.getEventDispatcher)().off(e)}},{key:"prepare",value:(t=v(p().mark((function e(t){var n,r,o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.uuidv4)(),e.next=3,(0,i.wait4)((function(){var e;return null!==(e=o.manager.ready())&&void 0!==e&&e}),(0,i.second)(10));case 3:if(e.sent){e.next=5;break}return e.abrupt("return",a.Status.FAILED);case 5:if(!(r=this.manager.connect(t,!1))){e.next=17;break}return e.next=9,(0,i.wait4)((function(){return r.getConnected()}),(0,i.second)(10));case 9:if(!e.sent){e.next=13;break}e.t1=(this.result.set(n,this.defaultResult),[n,r]),e.next=14;break;case 13:e.t1=a.Status.FAILED;case 14:e.t0=e.t1,e.next=18;break;case 17:e.t0=a.Status.FAILED;case 18:return e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"saveResult",value:function(e,t){this.result.set(e,t)}},{key:"waitForResult",value:(e=v(p().mark((function e(t){var n,r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.wait4)((function(){return r.result.get(t)!==r.defaultResult}),(0,i.second)(5));case 2:if(e.sent){e.next=4;break}return e.abrupt("return",this.defaultResult);case 4:return n=this.result.get(t),e.abrupt("return",(this.result.delete(t),null!=n?n:this.defaultResult));case 6:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e,t}()},483:function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){function t(){return _(this,t),y(this,t)}return g(t,e),C(t,[{key:"emit",value:function(e,t){var n=new CustomEvent(e,{detail:t});this.dispatchEvent(n)}},{key:"on",value:function(e,t){this.addEventListener(e,function(){var e=v(p().mark((function e(n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){t(n.detail)}),0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}])}(e(EventTarget));n.default=r},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NatDetectInterval=t.SentryNodeCloseCode=t.RequestFilePeerMode=t.ClientMode=t.FileMethod=t.PingMethod=t.BizCommand=t.WsCommand=t.ConnectionState=void 0;var r,i,a,o,s,u,c,l,f,d=n(686);!function(e){e[e.STATE_UNAVAILABLE=0]="STATE_UNAVAILABLE",e[e.STATE_CONNECTED=1]="STATE_CONNECTED",e[e.STATE_ALIVE=2]="STATE_ALIVE"}(r||(t.ConnectionState=r={})),function(e){e[e.REGISTER=1]="REGISTER",e[e.KEEPALIVE=4]="KEEPALIVE",e[e.SERVERPING=5]="SERVERPING"}(i||(t.WsCommand=i={})),function(e){e[e.MAKEHOLE=2]="MAKEHOLE",e[e.METRICS=6]="METRICS"}(a||(t.BizCommand=a={})),function(e){e.PING="ping",e.PING2="ping2",e.PONG="pong",e.PONG2="pong2"}(o||(t.PingMethod=o={})),function(e){e.REQUEST="file::request",e.META="file::meta",e.ERROR="file::error",e[e.CHUNK=1]="CHUNK"}(s||(t.FileMethod=s={})),function(e){e.DCDN="dcdn",e.CLIENT="client"}(u||(t.ClientMode=u={})),function(e){e.AUTO="auto",e.MANUAL="manual"}(c||(t.RequestFilePeerMode=c={})),function(e){e[e.SERVER_BANNED_CLOSE=4e3]="SERVER_BANNED_CLOSE",e[e.IP_UNSUPPORTED_CLOSE=4001]="IP_UNSUPPORTED_CLOSE"}(l||(t.SentryNodeCloseCode=l={})),function(e){e[e.DEFAULT=(0,d.minute)(10)]="DEFAULT",e[e.QUICK=(0,d.minute)(1)]="QUICK"}(f||(t.NatDetectInterval=f={}))},524:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRelayClient=function(e,t){return i?(s.default.warn("[RelayClient] relay client already exists"),i):i=new l(e,t)},t.getRelayClient=function(){if(i)return i;s.default.error("[RelayClient] relay client not found")};var i,a=n(498),o=r(n(483)),s=r(n(39)),u=r(n(609)),c=n(686),l=function(e){function t(e,n){var r;return _(this,t),(r=y(this,t)).wsUrl=void 0,r.reconnectInterval=u.default.getMinReconnectInterval(),r.state=a.ConnectionState.STATE_UNAVAILABLE,r.heartbeatTime=0,r.peerID=e,r.token=n,r.wsUrl=u.default.getWsUrl(),r.reconnectInterval=u.default.getMinReconnectInterval(),r.connect(n),r.externalMessageHandler=function(){},r}return g(t,e),C(t,[{key:"addExternalMessageHandler",value:function(e){this.externalMessageHandler=e}},{key:"removeExternalMessageHandler",value:function(){this.externalMessageHandler=function(){}}},{key:"send",value:function(e,t){var n,r={cmd:e,data:JSON.stringify(t)};s.default.debug("[RelayClient] send message",r),null===(n=this.ws)||void 0===n||n.send(JSON.stringify(r))}},{key:"getConnected",value:function(){return this.state===a.ConnectionState.STATE_ALIVE}},{key:"stopConnection",value:function(e,t){this.ws&&this.ws.readyState==WebSocket.OPEN&&(s.default.info("[RelayClient] stop connection",e,t),this.ws.close(e,t))}},{key:"connect",value:function(e){var n=this;this.heartbeatTime=0,this.wsUrl?(u.default.isOldWsUrl()?this.ws=new WebSocket(this.wsUrl):this.ws=new WebSocket(this.wsUrl,["auth",e]),this.ws.onopen=function(){var e=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.default.info("[RelayClient] connection opened",t),n.state=a.ConnectionState.STATE_CONNECTED,n.initConnect();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ws.onmessage=function(e){n.heartbeatTime=Date.now();var r=JSON.parse(e.data);switch(s.default.debug("[RelayClient] receive message",r),r.cmd){case a.WsCommand.REGISTER:n.state===a.ConnectionState.STATE_CONNECTED&&(n.state=a.ConnectionState.STATE_ALIVE,n.reconnectInterval=u.default.getMinReconnectInterval(),k(t,"emit",n,3)(["connect",{}]));break;case a.WsCommand.KEEPALIVE:break;case a.WsCommand.SERVERPING:var i=JSON.parse(r.data);n.send(a.WsCommand.SERVERPING,i);break;default:k(t,"emit",n,3)(["data",r]),n.externalMessageHandler(r)}},this.ws.onerror=function(e){s.default.error("[RelayClient] connection error",e)},this.ws.onclose=function(e){s.default.info("[RelayClient] connection closed",JSON.stringify(e)),n.state=a.ConnectionState.STATE_UNAVAILABLE,clearInterval(n.keepaliveInterval),e.code==a.SentryNodeCloseCode.SERVER_BANNED_CLOSE?s.default.info("[RelayClient] onclose 4000"):e.code==a.SentryNodeCloseCode.IP_UNSUPPORTED_CLOSE?s.default.info("[RelayClient] onclose 4001"):n.reconnect()}):s.default.error("[RelayClient] wsUrl is not set")}},{key:"initConnect",value:(o=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.default.isOldWsUrl()){e.next=10;break}return e.next=3,this.register();case 3:if(!e.sent){e.next=7;break}s.default.info("[RelayClient] register success"),this.keepAlive(),e.next=8;break;case 7:s.default.error("[RelayClient] register failed");case 8:e.next=11;break;case 10:this.keepAlive(),this.state=a.ConnectionState.STATE_ALIVE,this.reconnectInterval=u.default.getMinReconnectInterval(),k(t,"emit",this,3)(["connect",{}]);case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"register",value:(i=v(p().mark((function e(){var t=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.send(a.WsCommand.REGISTER,{peer_id:this.peerID,sdk_version:u.default.getSdkVersion(),time_zone:(0,c.getTimeZone)()}),(0,c.wait4)((function(){return t.getConnected()}),(0,c.second)(1))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"keepAlive",value:(r=v(p().mark((function e(){var t=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.keepaliveInterval=setInterval(v(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.send(a.WsCommand.KEEPALIVE,{peer_id:t.peerID}),e.next=3,(0,c.wait4)((function(){return Date.now()-t.heartbeatTime<=3*u.default.getKeepaliveInterval()}),(0,c.second)(1));case 3:if(e.t0=e.sent,e.t0){e.next=6;break}null===(n=t.ws)||void 0===n||n.close();case 6:case"end":return e.stop()}}),e)}))),u.default.getKeepaliveInterval());case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"reconnect",value:(n=v(p().mark((function e(){var t,n,r,i=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.reconnectInterval=Math.max(null!==(t=this.reconnectInterval)&&void 0!==t?t:0,u.default.getMinReconnectInterval()),this.reconnectInterval=Math.min(this.reconnectInterval,u.default.getMaxReconnectInterval()),n=Math.floor(Math.random()*u.default.getReconnectIntervalOffset()),r=u.default.getQuickReconnect()?1e3:this.reconnectInterval+n,s.default.info("[RelayClient] trying to reconnect in",r),setTimeout((function(){i.connect(i.token)}),r),this.reconnectInterval*=2;case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]);var n,r,i,o}(o.default)},567:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(962)),a=n(524),o=r(n(609)),s=r(n(893));t.default=function(){return C((function e(t){_(this,e),o.default.init(t.peer,t.testEnv),o.default.setSkey(t.skey),t.clientMode&&o.default.setClientMode(t.clientMode),(0,a.createRelayClient)(t.peer.id,t.token),(0,s.default)(),this.client=new i.default(t.components)}),[{key:"setSkey",value:function(e){o.default.setSkey(e)}},{key:"ping",value:(x=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.client)||void 0===n?void 0:n.ping(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getFileList",value:(E=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.client)||void 0===t?void 0:t.getFileList());case 1:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"saveFile",value:(S=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=this.client)||void 0===r?void 0:r.saveFile(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"deleteFile",value:(k=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.client)||void 0===n?void 0:n.deleteFile(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"getEvents",value:(w=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.client)||void 0===t?void 0:t.getEvents());case 1:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"getConnectedPeers",value:(g=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.client)||void 0===t?void 0:t.getConnectedPeers());case 1:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getFileByMeta",value:(b=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.getFileByMeta(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"requestFile",value:(m=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.requestFile(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"requestHolders",value:(y=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=this.client)||void 0===r?void 0:r.requestHolders(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"requestFileTestV2",value:(h=v(p().mark((function e(t,n){var r,i,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>2&&void 0!==a[2]?a[2]:6e4,e.next=3,null===(r=this.client)||void 0===r?void 0:r.requestFileTestV2(t,n,i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"requestFileTestAuto",value:(d=v(p().mark((function e(t){var n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:6e4,e.next=3,null===(n=this.client)||void 0===n?void 0:n.requestFileTestAuto(t,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"reportDcdnRequest",value:(f=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=this.client)||void 0===r?void 0:r.reportDcdnRequest(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"getDcdnStatistics",value:(l=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.getDcdnStatistics(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"detectNat",value:(c=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.client)||void 0===t?void 0:t.detectNat();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"addComponent",value:(u=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.addComponent(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"removeComponent",value:(r=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.removeComponent(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"hasComponent",value:function(e){var t;return null===(t=this.client)||void 0===t?void 0:t.hasComponent(e)}},{key:"getSentryNodeWssStatus",value:function(){return!!this.client&&this.client.getSentryNodeWssStatus()}},{key:"requestFileByP2P",value:(n=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.requestFileByP2P(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"requestFileByCDN",value:(t=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.client)||void 0===n?void 0:n.requestFileByCDN(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"sentryNodePublish",value:(e=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=this.client)||void 0===r?void 0:r.sentryNodePublish(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"addSentryNodeMessageHandler",value:function(e){var t;return null===(t=this.client)||void 0===t?void 0:t.addSentryNodeMessageHandler(e)}},{key:"stopSentryNodeWss",value:function(e,t){var n;return null===(n=this.client)||void 0===n?void 0:n.stopSentryNodeWss(e,t)}}]);var e,t,n,r,u,c,l,f,d,h,y,m,b,g,w,k,S,E,x}()},584:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return C((function e(t,n){_(this,e),this.dbName=t,this.storeNames=n}),[{key:"openDB",value:(r=v(p().mark((function e(){var t=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=indexedDB.open(t.dbName,1);r.onupgradeneeded=function(){var e=r.result,n=t.storeNames.filter((function(t){return!e.objectStoreNames.contains(t)}));n.forEach((function(t){e.createObjectStore(t,{keyPath:"id"})}))},r.onsuccess=function(){var t=r.result;e(t)},r.onerror=function(){n(r.error)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"saveObj",value:(n=v(p().mark((function e(t,n,r){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDB();case 2:return i=e.sent,e.abrupt("return",new Promise((function(e,a){var o=i.transaction(t,"readwrite").objectStore(t),s={id:n,obj:r},u=o.put(s);u.onsuccess=function(){return e()},u.onerror=function(){return a(u.error)}})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"getObj",value:(t=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDB();case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,i){var a=r.transaction(t,"readonly").objectStore(t).get(n);a.onsuccess=function(){var t=a.result;e(void 0===t?null:t.obj||null)},a.onerror=function(){return i(a.error)}})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"deleteObj",value:(e=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDB();case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,i){var a=r.transaction(t,"readwrite").objectStore(t).delete(n);a.onsuccess=function(){return e()},a.onerror=function(){return i(a.error)}})));case 4:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})}]);var e,t,n,r}()},594:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.natRes=void 0;var i=r(n(477)),a=n(686),o=n(948),s=n(398),u=r(n(150)),c={natType:4},l=(0,a.hour)(1),f=(0,a.minute)(10);t.natRes=new(function(){return C((function e(){_(this,e),this.trusted=!1,this.natType=4,this.updateAt=-1}),[{key:"update",value:function(e,t){this.natType=e,this.updateAt=Date.now(),this.trusted=t}},{key:"isNatExpired",value:function(){return this.trusted?this.updateAt+l<Date.now():this.updateAt+f<Date.now()}},{key:"getNatType",value:function(){return this.natType}},{key:"waitForValidNat",value:(e=v(p().mark((function e(t){var n,r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),e.abrupt("return",new Promise((function(e){var i=setInterval((function(){r.isNatExpired()||(clearInterval(i),e({success:!0,nat:r.natType})),Date.now()-n>t&&(clearInterval(i),e({success:!1,nat:r.natType}))}),100);setTimeout((function(){clearInterval(i),e({success:!1,nat:r.natType})}),t)})));case 3:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}]);var e}());var d=function(e){function n(e){var t;return _(this,n),(t=y(this,n,[e,c])).checkSymmetricTimeout=(0,a.second)(30),t}return g(n,e),C(n,[{key:"initEvent",value:function(){}},{key:"runDetectNat",value:(i=v(p().mark((function e(){var n,r,i,s=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.natRes.isNatExpired()){e.next=2;break}return e.abrupt("return",{success:!0,nat:t.natRes.getNatType()});case 2:return e.next=4,(0,o.checkSymmetric)(this.checkSymmetricTimeout);case 4:if(!(n=e.sent).finished||!n.isSymmetric){e.next=7;break}return e.abrupt("return",(t.natRes.update(4,!0),{success:!0,nat:4}));case 7:return e.next=10,v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.manager.connect("Virtual-NAT-1001",!1)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,a.wait4)((function(){return t.getConnected()}),(0,a.second)(2));case 5:return e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))();case 10:return r=e.sent,e.next=13,t.natRes.waitForValidNat((0,a.second)(30));case 13:return i=e.sent,e.abrupt("return",(r&&r.close(),i));case 15:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"detectNat",value:(r=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runDetectNat();case 2:return t=e.sent,e.abrupt("return",(t.success&&((0,s.emitCounter)("nat",1,{nat_type:t.nat}),u.default.setNatType(t.nat)),t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"kill",value:function(){}}]);var r,i}(i.default);t.default=d},609:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(39)),a=n(498),o=new(function(){return C((function e(){_(this,e),this.inited=!1,this.minReconnectInterval=3e3,this.keepaliveInterval=1e4,this.maxReconnectInterval=6e5,this.reconnectIntervalOffset=1e4,this.checkAliveInterval=1e3,this.connectionIdleTimeout=3e4,this.quickReconnect=!1,this.reportInterval=1e4,this.fetchTaskInterval=1e4,this.dbName="gradient-dcdn",this.clientMode=a.ClientMode.DCDN,this.iceTimeout=3e3,this.apiAppId=Number("1")||0,this.apiBaseUrl="MISSING_ENV_VAR".SEED_SERVER_API_BASE||"",this.enableEmitCounter=!0,this.maxServingPeers=Number("20")||5,this.downloadFromCDNOnly=!0,this.wsUrlProd="wss://wf.gradient.network/wss",this.wsUrlTest="wss://wf-dev.gradient.network/wss",this.seedServerApiBaseProd="https://psm.gradient.network",this.seedServerApiBaseTest="https://psm-dev.gradient.network",this.dbNameProd="gradient-dcdn",this.dbNameTest="gradient-dcdn-test",this.readEnv()}),[{key:"readEnv",value:function(){this.wsUrlProd="wss://wf.gradient.network/wss",this.wsUrlTest="wss://wf-dev.gradient.network/wss",this.seedServerApiBaseProd="https://psm.gradient.network",this.seedServerApiBaseTest="https://psm-dev.gradient.network",this.dbNameProd="MISSING_ENV_VAR".DB_NAME_PROD||"gradient-dcdn",this.dbNameTest="MISSING_ENV_VAR".DB_NAME_TEST||"gradient-dcdn-test",this.minReconnectInterval=Number("3000")||3e3,this.keepaliveInterval=Number("10000")||1e4,this.maxReconnectInterval=Number("300000")||6e5,this.reconnectIntervalOffset=Number("60000")||1e4,this.checkAliveInterval=Number("1000")||1e3,this.connectionIdleTimeout=Number("1800000")||3e4,this.quickReconnect=!1,this.reportInterval=Number("60000")||1e4,this.fetchTaskInterval=Number("60000")||1e4,this.iceTimeout=Number("6000")||3e3}},{key:"init",value:function(e,t){this.inited?i.default.error("[Conf] init already called"):(this.inited=!0,this.peerID=e.id,this.sdkVer="0.0.12",this.bizVer=e.biz_version,t?(this.wsUrl=this.wsUrlTest,this.apiBaseUrl=this.seedServerApiBaseTest,this.dbName=this.dbNameTest):(this.wsUrl=this.wsUrlProd,this.apiBaseUrl=this.seedServerApiBaseProd,this.dbName=this.dbNameProd))}},{key:"setSecretKey",value:function(e){this.skey=e}},{key:"setClientMode",value:function(e){this.clientMode=e}},{key:"getSdkVersion",value:function(){return this.sdkVer}},{key:"getBizVersion",value:function(){return this.bizVer}},{key:"getMinReconnectInterval",value:function(){return this.minReconnectInterval}},{key:"getKeepaliveInterval",value:function(){return this.keepaliveInterval}},{key:"getMaxReconnectInterval",value:function(){return this.maxReconnectInterval}},{key:"getReconnectIntervalOffset",value:function(){return this.reconnectIntervalOffset}},{key:"getWsUrl",value:function(){return this.isOldWsUrl()?"MISSING_ENV_VAR".OLD_WS_URL:this.wsUrl}},{key:"isOldWsUrl",value:function(){return!!"MISSING_ENV_VAR".OLD_WS_URL}},{key:"getCheckAliveInterval",value:function(){return this.checkAliveInterval}},{key:"getConnectionIdleTimeout",value:function(){return this.connectionIdleTimeout}},{key:"getPeerId",value:function(){return this.peerID}},{key:"getSkey",value:function(){return this.skey}},{key:"setSkey",value:function(e){this.skey=e}},{key:"getQuickReconnect",value:function(){return this.quickReconnect}},{key:"getDbName",value:function(){return this.dbName}},{key:"getReportInterval",value:function(){return this.reportInterval}},{key:"getFetchTaskInterval",value:function(){return this.fetchTaskInterval}},{key:"getClientMode",value:function(){return this.clientMode}},{key:"getIceTimeout",value:function(){return this.iceTimeout}},{key:"getApiAppId",value:function(){return this.apiAppId}},{key:"getApiBaseUrl",value:function(){return this.apiBaseUrl}},{key:"getEnableEmitCounter",value:function(){return this.enableEmitCounter}},{key:"getMaxServingPeers",value:function(){return this.maxServingPeers}},{key:"getDownloadFromCDNOnly",value:function(){return this.downloadFromCDNOnly}}])}());t.default=o},645:function(e,t){"use strict";var n,r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.P2PComponent=t.Status=t.FileTransferStatus=t.FileAction=void 0,function(e){e.PULL="pull",e.PUSH="push"}(n||(t.FileAction=n={})),function(e){e.SUCCESS="success",e.NOT_FOUND="not_found",e.ERROR="error"}(r||(t.FileTransferStatus=r={})),function(e){e.SUCCESS="success",e.FAILED="failed"}(i||(t.Status=i={})),function(e){e.PING_SERVICE="ping_service",e.FILE_SERVICE="file_service",e.NAT_DETECT_SERVICE="nat_detect_service",e.STATISTICS_SERVICE="statistics_service",e.SENTRY_NODE_SERVICE="sentry_node_service"}(a||(t.P2PComponent=a={}))},652:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.downloadFileFromCDN=function(){var e=v(p().mark((function e(t,n){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("Failed to download file from CDN: ".concat(r.status," ").concat(r.statusText));case 6:return e.next=8,r.blob();case 8:return i=e.sent,e.abrupt("return",new File([i],n,{type:i.type,lastModified:(new Date).getTime()}));case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Failed to download file from CDN: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()},686:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hour=function(e){return 60*e*60*1e3},t.minute=function(e){return 60*e*1e3},t.second=function(e){return 1e3*e},t.getTimeZone=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},t.wait4=function(){var e=v(p().mark((function e(t){var n,r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:36e5,r=Date.now();case 2:if(t()){e.next=9;break}if(!(Date.now()-r>=n)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,new Promise((function(e){return setTimeout(e,10)}));case 7:e.next=2;break;case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.hmac=function(){var e=v(p().mark((function e(t,n){var r,i,a,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","_");case 2:return r=new TextEncoder,i=r.encode(t),a=r.encode(n),e.next=7,self.crypto.subtle.importKey("raw",i,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);case 7:return o=e.sent,e.next=10,self.crypto.subtle.sign("HMAC",o,a);case 10:return s=e.sent,e.abrupt("return",Array.from(new Uint8Array(s)).map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.uuidv4=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(+e^self.crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)}))},t.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.fileMD5=function(){var e=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=2097152,a=new i.default.ArrayBuffer,o=new FileReader,s=0,u=Math.ceil(t.size/r);function c(){var e=s*r,n=Math.min(e+r,t.size);o.readAsArrayBuffer(t.slice(e,n))}o.onload=function(t){var r;(null===(r=t.target)||void 0===r?void 0:r.result)instanceof ArrayBuffer?(a.append(t.target.result),++s<u?c():e(a.end())):n(new Error("Failed to read file"))},o.onerror=function(e){n(e)},c()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.metaToString=function(e){return"".concat(e.app_id,"-").concat(e.file_id)},t.downloadFile=function(){var e=v(p().mark((function e(t,n){var r,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.blob();case 5:i=e.sent,(a=document.createElement("a")).href=URL.createObjectURL(i),a.download=n,a.click();case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.parseM3U8File=function(){var e=v(p().mark((function e(t){var n,r,i,o,s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:n=e.sent.split("\n"),r=[],i=a(n);try{for(i.s();!(o=i.n()).done;)s=o.value,(u=s.trim())&&!u.startsWith("#")&&u.endsWith(".ts")&&r.push(u)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.measureTTFB=function(){var e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=performance.now(),e.next=3,fetch(t,{method:"HEAD",mode:"no-cors"});case 3:return e.abrupt("return",performance.now()-n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var i=r(n(735))},735:function(e){e.exports=function(){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function t(e,t){var n=e[0],r=e[1],i=e[2],a=e[3];r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+t[1]-389564586|0)<<12|a>>>20)+n|0)&n|~a&r)+t[2]+606105819|0)<<17|i>>>15)+a|0)&a|~i&n)+t[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+t[5]+1200080426|0)<<12|a>>>20)+n|0)&n|~a&r)+t[6]-1473231341|0)<<17|i>>>15)+a|0)&a|~i&n)+t[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+t[9]-1958414417|0)<<12|a>>>20)+n|0)&n|~a&r)+t[10]-42063|0)<<17|i>>>15)+a|0)&a|~i&n)+t[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+t[13]-40341101|0)<<12|a>>>20)+n|0)&n|~a&r)+t[14]-1502002290|0)<<17|i>>>15)+a|0)&a|~i&n)+t[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+t[6]-1069501632|0)<<9|a>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|i>>>18)+a|0)&n|a&~n)+t[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+t[10]+38016083|0)<<9|a>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|i>>>18)+a|0)&n|a&~n)+t[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+t[14]-1019803690|0)<<9|a>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|i>>>18)+a|0)&n|a&~n)+t[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+t[2]-51403784|0)<<9|a>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|i>>>18)+a|0)&n|a&~n)+t[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+t[8]-2022574463|0)<<11|a>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|i>>>16)+a|0)^a^n)+t[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+t[4]+1272893353|0)<<11|a>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|i>>>16)+a|0)^a^n)+t[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+t[0]-358537222|0)<<11|a>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|i>>>16)+a|0)^a^n)+t[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+t[12]-421815835|0)<<11|a>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|i>>>16)+a|0)^a^n)+t[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+t[7]+1126891415|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[14]-1416354905|0)<<15|i>>>17)+a|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+t[3]-1894986606|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[10]-1051523|0)<<15|i>>>17)+a|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+t[15]-30611744|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[6]-1560198380|0)<<15|i>>>17)+a|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+t[11]-1120210379|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+t[2]+718787259|0)<<15|i>>>17)+a|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=a+e[3]|0}function n(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function r(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function i(e){var r,i,a,o,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=c;r+=64)t(l,n(e.substring(r-64,r)));for(i=(e=e.substring(r-64)).length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<i;r+=1)a[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(t(l,a),r=0;r<16;r+=1)a[r]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(o[2],16),u=parseInt(o[1],16)||0,a[14]=s,a[15]=u,t(l,a),l}function a(t){var n,r="";for(n=0;n<4;n+=1)r+=e[t>>8*n+4&15]+e[t>>8*n&15];return r}function o(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function s(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function u(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function c(){this.reset()}return o(i("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,n){var r,i,a,o,s=this.byteLength,u=e(t,s),c=s;return void 0!==n&&(c=e(n,s)),u>c?new ArrayBuffer(0):(r=c-u,i=new ArrayBuffer(r),a=new Uint8Array(i),o=new Uint8Array(this,u,r),a.set(o),i)}}(),c.prototype.append=function(e){return this.appendBinary(s(e)),this},c.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var r,i=this._buff.length;for(r=64;r<=i;r+=64)t(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},c.prototype.end=function(e){var t,n,r=this._buff,i=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)a[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(a,i),n=o(this._hash),e&&(n=u(n)),this.reset(),n},c.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},c.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},c.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},c.prototype._finish=function(e,n){var r,i,a,o=n;if(e[o>>2]|=128<<(o%4<<3),o>55)for(t(this._hash,e),o=0;o<16;o+=1)e[o]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(r[2],16),a=parseInt(r[1],16)||0,e[14]=i,e[15]=a,t(this._hash,e)},c.hash=function(e,t){return c.hashBinary(s(e),t)},c.hashBinary=function(e,t){var n=o(i(e));return t?u(n):n},c.ArrayBuffer=function(){this.reset()},c.ArrayBuffer.prototype.append=function(e){var n,i,a,o,s=(i=this._buff.buffer,a=e,(o=new Uint8Array(i.byteLength+a.byteLength)).set(new Uint8Array(i)),o.set(new Uint8Array(a),i.byteLength),o),u=s.length;for(this._length+=e.byteLength,n=64;n<=u;n+=64)t(this._hash,r(s.subarray(n-64,n)));return this._buff=n-64<u?new Uint8Array(s.buffer.slice(n-64)):new Uint8Array(0),this},c.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,i=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)a[t>>2]|=r[t]<<(t%4<<3);return this._finish(a,i),n=o(this._hash),e&&(n=u(n)),this.reset(),n},c.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.ArrayBuffer.prototype.getState=function(){var e,t=c.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},c.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e){var t,n=e.length,r=new ArrayBuffer(n),i=new Uint8Array(r);for(t=0;t<n;t+=1)i[t]=e.charCodeAt(t);return i}(e.buff),c.prototype.setState.call(this,e)},c.ArrayBuffer.prototype.destroy=c.prototype.destroy,c.ArrayBuffer.prototype._finish=c.prototype._finish,c.ArrayBuffer.hash=function(e,n){var i=o(function(e){var n,i,a,o,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)t(l,r(e.subarray(n-64,n)));for(i=(e=n-64<c?e.subarray(n-64):new Uint8Array(0)).length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<i;n+=1)a[n>>2]|=e[n]<<(n%4<<3);if(a[n>>2]|=128<<(n%4<<3),n>55)for(t(l,a),n=0;n<16;n+=1)a[n]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(o[2],16),u=parseInt(o[1],16)||0,a[14]=s,a[15]=u,t(l,a),l}(new Uint8Array(e)));return n?u(i):i},c}()},758:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(190),a=r(n(609));t.default=function(){return C((function e(){_(this,e),this.currentPerf={speed:0,latency:0},this.fileStartTimestamp=null,this.firstChunkTimestamp=null,this.appId=a.default.getApiAppId()}),[{key:"reportDcdnRequest",value:(t=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={metric_type:i.MetricType.CDN_REQUEST_STATUS,content:{app_id:this.appId,fid:t,typ:n}},e.abrupt("return",(0,i.reportStatistics)(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getDcdnStatistics",value:(e=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,i.getStatistics)(t,this.appId));case 1:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"flagFileStart",value:function(){this.fileStartTimestamp=Date.now()}},{key:"flagChunk",value:function(){this.fileStartTimestamp&&(this.firstChunkTimestamp||(this.firstChunkTimestamp=Date.now(),this.currentPerf.latency=this.firstChunkTimestamp-this.fileStartTimestamp))}},{key:"flagFileEnd",value:function(e){var t,n,r=null!==(t=null!==(n=this.firstChunkTimestamp)&&void 0!==n?n:this.fileStartTimestamp)&&void 0!==t?t:0;if(0!==r){var i=Date.now()-r;this.currentPerf.speed=e/i,this.fileStartTimestamp=null,this.firstChunkTimestamp=null}}},{key:"flagCdnStatis",value:function(e,t,n){this.currentPerf.latency=e,this.currentPerf.speed=n/t}}]);var e,t}()},841:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.reportDeviceInfo=function(){var e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.post("".concat(s.default.getApiBaseUrl(),"/seed_manager/device/report/all"),t);case 2:return n=e.sent,e.abrupt("return",0!==n.data.code?(a.default.error("[reportDeviceInfo] failed: ".concat(n.data.code," ").concat(n.data.message)),i.Status.FAILED):i.Status.SUCCESS);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getDownloadTask=function(){var e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.get("".concat(s.default.getApiBaseUrl(),"/seed_manager/device/task?peer_id=").concat(t));case 2:return n=e.sent,e.abrupt("return",0!==n.data.code?(a.default.error("[getDownloadTask] failed: ".concat(n.data.code," ").concat(n.data.message)),i.Status.FAILED):n.data.data.tasks);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getResourceHolders=function(){var e=v(p().mark((function e(t,n){var r,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(s.default.getApiBaseUrl(),"/seed_manager/sdk/list?app_id=").concat(t.app_id,"&fid=").concat(t.fid,"&url=").concat(t.url,"&nat=").concat(n),t.index_id&&(r+="&index_id=".concat(t.index_id)),e.next=4,o.default.get(r);case 4:return u=e.sent,e.abrupt("return",0!==u.data.code?(a.default.error("[getResourceHolders] failed: ".concat(u.data.code," ").concat(u.data.message)),i.Status.FAILED):u.data.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.reportStatistics=function(){var e=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.post("".concat(s.default.getApiBaseUrl(),"/seed_manager/metric/upload"),f(f({},t),{},{content:JSON.stringify(t.content)}));case 2:return n=e.sent,e.abrupt("return",0!==n.data.code?(a.default.error("[reportStatistics] failed: ".concat(n.data.code," ").concat(n.data.message)),i.Status.FAILED):i.Status.SUCCESS);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getStatistics=function(){var e=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.get("".concat(s.default.getApiBaseUrl(),"/seed_manager/metric/summary?app_id=").concat(n,"&fid=").concat(t));case 2:return r=e.sent,e.abrupt("return",null==r?void 0:r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var i=n(645),a=r(n(39)),o=r(n(425)),s=r(n(609))},868:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i,o=r(n(609)),s=r(n(584)),u=r(n(39));!function(e){e.FILE="file",e.META="meta"}(i||(i={})),t.default=function(){return C((function e(){_(this,e);var t="".concat(o.default.getDbName(),"-").concat(o.default.getPeerId());if(!t)throw new Error("env: DB_NAME is not set");this.db=new s.default(t,[i.FILE,i.META]),this.inited=!1}),[{key:"init",value:(c=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inited){e.next=12;break}return e.next=3,this.db.getObj(i.META,"status");case 3:if(!e.sent){e.next=7;break}e.t0=(u.default.info("StatusDB initialized before"),void(this.inited=!0)),e.next=11;break;case 7:return u.default.info("First run, initializing status"),e.next=10,this.db.saveObj(i.META,"status",{holds:[]});case 10:e.t0=void e.sent;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"findFileByMeta",value:(r=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return n="".concat(t.app_id,"-").concat(t.file_id),e.next=5,this.db.getObj(i.FILE,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"saveFile",value:(n=v(p().mark((function e(t,n,r){var o,s,u,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return o="".concat(t.app_id,"-").concat(t.file_id),e.next=5,this.db.saveObj(i.FILE,o,n);case 5:return e.next=7,this.getStatus();case 7:s=e.sent,u=!1,c=a(s.holds),e.prev=10,c.s();case 12:if((l=c.n()).done){e.next=19;break}if((d=l.value).app_id!==t.app_id||d.file_id!==t.file_id){e.next=17;break}return u=!0,e.abrupt("break",19);case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:if(e.t1=u,e.t1){e.next=32;break}return s.holds.push(f(f({},t),{},{from:r,time:Date.now()})),e.next=32,this.db.saveObj(i.META,"status",s);case 32:case"end":return e.stop()}}),e,this,[[10,21,24,27]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"deleteFile",value:(t=v(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return n="".concat(t.app_id,"-").concat(t.file_id),e.next=5,this.db.deleteObj(i.FILE,n);case 5:return e.next=7,this.getStatus();case 7:return(r=e.sent).holds=r.holds.filter((function(e){return e.app_id!==t.app_id||e.file_id!==t.file_id})),e.next=11,this.db.saveObj(i.META,"status",r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getStatus",value:(e=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this.db.getObj(i.META,"status");case 4:if(t=e.sent){e.next=7;break}throw new Error("StatusDB is not initialized");case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t,n,r,c}()},893:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},917:function(e,n,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.EventDispatcher=void 0,n.getEventDispatcher=function(){return s};var a=i(r(39)),o=function(){return C((function e(){_(this,e),this.handlers=new Map}),[{key:"on",value:function(e,t){this.handlers.set(e,t)}},{key:"off",value:function(e){this.handlers.delete(e)}},{key:"dispatch",value:function(e,n){var r;if(n instanceof Uint8Array&&(n=n.buffer),"string"==typeof n)r=JSON.parse(n);else{if(!(n instanceof ArrayBuffer))return void a.default.error("[EventDispatcher] unexpected message type: "+t(n));var i=new DataView(n),o=i.getUint16(0,!0),s=i.getUint8(2),u=new Uint8Array(n,3,s);r={method:o,task_id:(new TextDecoder).decode(u),data:new Uint8Array(n,3+s)}}var c=this.handlers.get(r.method);c?c(e,r):a.default.error("[EventDispatcher] unexpected method: ".concat(r.method))}},{key:"getHandlers",value:function(){return this.handlers}}])}();n.EventDispatcher=o;var s=new o},929:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(524);t.default=function(){return C((function e(){_(this,e)}),[{key:"getConnected",value:function(){var e=(0,r.getRelayClient)();return!!e&&e.getConnected()}},{key:"stopConnection",value:function(e,t){var n=(0,r.getRelayClient)();n&&n.stopConnection(e,t)}},{key:"publish",value:function(e,t){var n=(0,r.getRelayClient)();n&&n.send(e,t)}},{key:"addMessageHandler",value:function(e){var t=(0,r.getRelayClient)();t&&t.addExternalMessageHandler(e)}},{key:"removeMessageHandler",value:function(){var e=(0,r.getRelayClient)();e&&e.removeExternalMessageHandler()}}])}()},948:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkSymmetric=function(e){return new Promise((function(t){var n=Date.now(),r={finished:!1,isSymmetric:!1,duration:0},i={},a=!1;if(self.RTCPeerConnection){var o=new RTCPeerConnection({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun.cloudflare.com:3478"}]});o.onconnectionstatechange=function(){},o.oniceconnectionstatechange=function(){},o.onicegatheringstatechange=function(){"complete"===o.iceGatheringState&&a&&(clearTimeout(u),s(!0))};var s=function(e){if(o.close(),1===Object.keys(i).length){var a=i[Object.keys(i)[0]];r.isSymmetric=1!==a.length,r.finished=e}var s=Date.now();r.duration=(s-n)/1e3,t(r)},u=self.setTimeout((function(){s(!1)}),e);o.onicecandidate=function(e){if(e.candidate){if(-1!==e.candidate.candidate.indexOf("srflx")){a=!0;var t=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1]}return n}(e.candidate.candidate);i[t.foundation]||(i[t.foundation]=[]),i[t.foundation].push(t.port)}}else s(!0)},o.createDataChannel("checkSymmetric-".concat(Date.now())),o.createOffer().then((function(e){return o.setLocalDescription(e)})).catch((function(){clearTimeout(u),s(!1)}))}else t({finished:!1,isSymmetric:!0,duration:0})}))}},962:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(609)),a=r(n(195)),o=r(n(39)),s=r(n(157)),u=n(917),c=n(645),l=r(n(150)),f=r(n(326)),d=r(n(222)),h=r(n(594)),y=r(n(758)),m=n(398),b=n(686),g=r(n(929));t.default=function(){return C((function e(t){var n=this;_(this,e),this.firstReportComponentsInterval=(0,b.second)(10),this.componentsReportIntervalTime=(0,b.minute)(60);var r=i.default.getPeerId();r?(l.default.setPeerId(r),this.manager=new a.default(r),t.forEach((function(e){n.addComponent(e)})),this.manager.setMessageHandler((function(e,t){(0,u.getEventDispatcher)().dispatch(e,t)})),this.fileServiceV2&&this.statisticsService&&this.fileServiceV2.bindStatisticsService(this.statisticsService),this.natDetectService&&this.manager.bindNatDetectService(this.natDetectService),this.firstReportComponentsTimer=setTimeout((function(){n.reportComponents()}),this.firstReportComponentsInterval),this.componentsReportInterval=setInterval((function(){n.reportComponents()}),this.componentsReportIntervalTime)):o.default.error("[PingClient] peerId not set")}),[{key:"getCurrentComponents",value:function(){var e=[];return this.pingService&&e.push(c.P2PComponent.PING_SERVICE),this.fileServiceV2&&e.push(c.P2PComponent.FILE_SERVICE),this.natDetectService&&e.push(c.P2PComponent.NAT_DETECT_SERVICE),this.statisticsService&&e.push(c.P2PComponent.STATISTICS_SERVICE),this.sentryNodeService&&e.push(c.P2PComponent.SENTRY_NODE_SERVICE),e}},{key:"reportComponents",value:function(){(0,m.emitCounter)(m.MetricNames.SDK_COMPONENTS,1,{ping_service:this.pingService?"1":"0",file_service:this.fileServiceV2?"1":"0",nat_detect_service:this.natDetectService?"1":"0",statistics_service:this.statisticsService?"1":"0",sentry_node_service:this.sentryNodeService?"1":"0"})}},{key:"reportDcdnRequest",value:(M=v(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.statisticsService){e.next=2;break}throw new Error("[Client] statisticsService not initialized");case 2:return e.abrupt("return",this.statisticsService.reportDcdnRequest(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"getDcdnStatistics",value:(F=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.statisticsService){e.next=2;break}throw new Error("[Client] statisticsService not initialized");case 2:return e.abrupt("return",this.statisticsService.getDcdnStatistics(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"ping",value:(D=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(n=this.pingService)||void 0===n?void 0:n.ping(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"getFileList",value:(I=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.abrupt("return",this.fileServiceV2.getFileList());case 3:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"saveFile",value:(N=v(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.abrupt("return",this.fileServiceV2.saveFile(t,n,"client"));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return N.apply(this,arguments)})},{key:"deleteFile",value:(A=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.abrupt("return",this.fileServiceV2.deleteFile(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"getEvents",value:(O=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.default.getAllEvents());case 1:case"end":return e.stop()}}),e)}))),function(){return O.apply(this,arguments)})},{key:"getConnectedPeers",value:(P=v(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.fileServiceV2)||void 0===t?void 0:t.getConnectedPeers());case 1:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"getFileByMeta",value:(R=v(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.fileServiceV2)||void 0===n?void 0:n.getFileByMeta(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"requestHolders",value:(T=v(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=this.fileServiceV2)||void 0===r?void 0:r.requestHolders(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return T.apply(this,arguments)})},{key:"requestFile",value:(x=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.next=4,this.fileServiceV2.requestFile(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"requestFileTestV2",value:(E=v(p().mark((function e(t,n){var r,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:6e4,this.fileServiceV2){e.next=3;break}throw new Error("[Client] fileServiceV2 not initialized");case 3:return e.next=5,this.fileServiceV2.requestFileTestV2(t,n,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return E.apply(this,arguments)})},{key:"requestFileTestAuto",value:(S=v(p().mark((function e(t){var n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:6e4,this.fileServiceV2){e.next=3;break}throw new Error("[Client] fileServiceV2 not initialized");case 3:return e.next=5,this.fileServiceV2.requestFileTestAuto(t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"detectNat",value:(k=v(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.natDetectService){e.next=2;break}throw new Error("[Client] natDetectService not initialized");case 2:return e.next=4,this.natDetectService.detectNat();case 4:return e.abrupt("return",e.sent.nat);case 5:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"addComponent",value:(w=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.manager){e.next=2;break}throw new Error("[Client] manager not initialized");case 2:e.t0=t,e.next=e.t0===c.P2PComponent.PING_SERVICE?5:e.t0===c.P2PComponent.FILE_SERVICE?7:e.t0===c.P2PComponent.NAT_DETECT_SERVICE?9:e.t0===c.P2PComponent.STATISTICS_SERVICE?11:e.t0===c.P2PComponent.SENTRY_NODE_SERVICE?13:15;break;case 5:return this.pingService=new s.default(this.manager),e.abrupt("break",16);case 7:return this.fileServiceV2=new f.default(this.manager),e.abrupt("break",16);case 9:return this.natDetectService=new h.default(this.manager),e.abrupt("break",16);case 11:return this.statisticsService=new y.default,e.abrupt("break",16);case 13:return this.sentryNodeService=new g.default,e.abrupt("break",16);case 15:o.default.error("[Client] unknown component",t);case 16:case 17:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"removeComponent",value:(r=v(p().mark((function e(t){var n,r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.manager){e.next=2;break}throw new Error("[Client] manager not initialized");case 2:e.t0=t,e.next=e.t0===c.P2PComponent.PING_SERVICE?5:e.t0===c.P2PComponent.FILE_SERVICE?7:e.t0===c.P2PComponent.NAT_DETECT_SERVICE?9:e.t0===c.P2PComponent.STATISTICS_SERVICE?11:13;break;case 5:return null!==(n=this.pingService)&&void 0!==n&&n.kill(),this.pingService=void 0,e.abrupt("break",14);case 7:return null!==(r=this.fileServiceV2)&&void 0!==r&&r.kill(),this.fileServiceV2=void 0,e.abrupt("break",14);case 9:return null!==(i=this.natDetectService)&&void 0!==i&&i.kill(),this.natDetectService=void 0,e.abrupt("break",14);case 11:return this.statisticsService=void 0,e.abrupt("break",14);case 13:o.default.error("[Client] unknown component",t);case 14:case 15:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"hasComponent",value:function(e){return this.getCurrentComponents().includes(e)}},{key:"requestFileByP2P",value:(n=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.next=4,this.fileServiceV2.requestFileByP2P(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"requestFileByCDN",value:(t=v(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileServiceV2){e.next=2;break}throw new Error("[Client] fileServiceV2 not initialized");case 2:return e.next=4,this.fileServiceV2.requestFileByCDN(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"sentryNodePublish",value:(e=v(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sentryNodeService){e.next=2;break}throw new Error("[Client] sentryNodeService not initialized");case 2:return e.abrupt("return",this.sentryNodeService.publish(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"getSentryNodeWssStatus",value:function(){return!!this.sentryNodeService&&this.sentryNodeService.getConnected()}},{key:"addSentryNodeMessageHandler",value:function(e){if(!this.sentryNodeService)throw new Error("[Client] sentryNodeService not initialized");return this.sentryNodeService.addMessageHandler(e)}},{key:"removeSentryNodeMessageHandler",value:function(){if(!this.sentryNodeService)throw new Error("[Client] sentryNodeService not initialized");return this.sentryNodeService.removeMessageHandler()}},{key:"stopSentryNodeWss",value:function(e,t){if(!this.sentryNodeService)throw new Error("[Client] sentryNodeService not initialized");return this.sentryNodeService.stopConnection(e,t)}}]);var e,t,n,r,w,k,S,E,x,T,R,P,O,A,N,I,D,F,M}()}},l={};function h(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={exports:{}};return c[e].call(n.exports,n,n.exports,h),n.exports}h.g=function(){if("object"==("undefined"==typeof globalThis?"undefined":t(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==("undefined"==typeof self?"undefined":t(self)))return self}}();var b=h(567);self.P2PSDK=b.default}()}}]);